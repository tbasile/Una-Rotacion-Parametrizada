\documentclass[10pt,letterpaper]{article} % {{{
\usepackage[top=0.85in,left=2.75in,footskip=0.75in]{geometry}
\usepackage{amsmath,amssymb}
% Use adjustwidth environment to exceed column width (see example table in text)
\usepackage{changepage}

% textcomp cpackage and marvosym package for additional characters
\usepackage{textcomp,marvosym}
\usepackage{subcaption}


% cite package, to clean up citations in the main text. Do not remove.
\usepackage{cite}

% Use nameref to cite supporting information files (see Supporting Information section for more info)
\usepackage{nameref,hyperref}

% line numbers
\usepackage[right]{lineno}

% ligatures disabled
\usepackage[nopatch=eqnum]{microtype}
\DisableLigatures[f]{encoding = *, family = * }

% color can be used to apply background shading to table cells only
\usepackage[table]{xcolor}

% array package and thick rules for tables
\usepackage{array}
\usepackage{caption}
\captionsetup[figure]{labelfont={bf},labelformat={default},labelsep=period,name={Fig}}


% create "+" rule type for thick vertical lines
\newcolumntype{+}{!{\vrule width 2pt}}

% create \thickcline for thick horizontal lines of variable length
\newlength\savedwidth
\newcommand\thickcline[1]{%
  \noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
  \cline{#1}%
  \noalign{\vskip\arrayrulewidth}%
  \noalign{\global\arrayrulewidth\savedwidth}%
}

% \thickhline command for thick horizontal lines that span the table
\newcommand\thickhline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
\hline
\noalign{\global\arrayrulewidth\savedwidth}}


% Remove comment for double spacing
%\usepackage{setspace} 
%\doublespacing

% Text layout
\raggedright
\setlength{\parindent}{0.5cm}
\textwidth 5.25in 
\textheight 8.75in

% Bold the 'Figure #' in the caption and separate it from the title/caption with a period
% Captions will be left justified
\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}
\renewcommand{\figurename}{Fig}
\renewcommand{\succ}{\textrm{succ}}

\newcommand{\fref}[1]{Fig~\ref{#1}}
\newcommand{\eref}[1]{Eq~(\ref{#1})}
% Use the PLoS provided BiBTeX style
\bibliographystyle{plos2015}

% Remove brackets from numbering in List of References
\makeatletter
\renewcommand{\@biblabel}[1]{\quad#1.}
\makeatother



% Header and Footer with logo
\usepackage{lastpage,fancyhdr,graphicx}
\usepackage{epstopdf}



\usepackage[english]{babel}
\usepackage{graphicx,helvet}
\usepackage{color}
\usepackage{url}
\usepackage{amssymb}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage[inline]{showlabels}
\usepackage{bbm,bm}
\usepackage{soul}
\usepackage{amsfonts}
\usepackage{showlabels}

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{quantikz}

\usepackage[draft,inline,nomargin]{fixme} \fxsetup{theme=color}
\FXRegisterAuthor{cp}{acp}{\color{blue}CP}
\FXRegisterAuthor{tb}{ttb}{\color{green}TB}




%\pagestyle{myheadings}
\pagestyle{fancy}
\fancyhf{}
%\setlength{\headheight}{27.023pt}
%\lhead{\includegraphics[width=2.0in]{PLOS-submission.eps}}
\rfoot{\thepage/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrule}{\hrule height 2pt \vspace{2mm}}
\fancyheadoffset[L]{2.25in}
\fancyfootoffset[L]{2.25in}
\lfoot{\today}

%% Include all macros below

\newcommand{\lorem}{{\bf LOREM}}
\newcommand{\ipsum}{{\bf IPSUM}}
\DeclareMathOperator{\tr}{tr}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}

%% END MACROS SECTION

% }}}
\begin{document}
% Titulo, afiliacion, abstract  {{{
\vspace*{0.2in}

% Title must be 250 characters or less.


\begin{flushleft}
{\Large
\textbf\newline{Quantum simulation of Pauli channels and dynamical maps: algorithm and implementation } % Please use "sentence case" for title and headings (capitalize only the first word in a title (or heading), the first word in a subtitle (or subheading), and any proper nouns).
}
\newline
% Insert author names, affiliations and corresponding author email (do not include titles, positions, or degrees).
\\
Tomás Basile\textsuperscript{1,2\Yinyang},
Carlos Pineda\textsuperscript{2*\Yinyang},
\\
\bigskip
\textbf{1} Facultad de Ciencias. Universidad Nacional Autónoma de México, Ciudad de México 01000, Mexico
\\
\textbf{2} Instituto de Física, Universidad Nacional Autónoma de México, Ciudad de México 01000, México
\\
\bigskip

% Insert additional author notes using the symbols described below. Insert symbol callouts after author names as necessary.
% 
% Remove or comment out the author notes below if they aren't used.
%
% Primary Equal Contribution Note
\Yinyang These authors contributed equally to this work.

% Additional Equal Contribution Note
% Also use this double-dagger symbol for special authorship notes, such as senior authorship.
% \ddag These authors also contributed equally to this work.

% Current address notes
% \textcurrency Current Address: Dept/Program/Center, Institution Name, City, State, Country % change symbol to "\textcurrency a" if more than one current address note
% \textcurrency b Insert second current address 
% \textcurrency c Insert third current address

% Deceased author note
% \dag Deceased

% Group/Consortium Author Note
% \textpilcrow Membership list can be found in the Acknowledgments section.

% Use the asterisk to denote corresponding authorship and provide email address in note below.
* carlospgmat03@gmail.com

\end{flushleft}
% Please keep the abstract below 300 words
\section*{Abstract}
\cpnote{Revisar}
Pauli channels are fundamental in the context of quantum computing as they
model noise in quantum devices.  We propose a quantum algorithm for simulating
Pauli channels on quantum computers 
and extend it to encompass Pauli dynamical maps 
(parametrized Pauli channels).
A parametrized quantum circuit is employed to accommodate for dynamical maps. 
We also establish the mathematical conditions for an
N-qubit transformation to be achievable using a parametrized circuit where
only one single-qubit operation depends on the parameter. 
The implementation of the proposed circuit is demonstrated using IBM's quantum computers 
for the case of one qubit, and the fidelity of this implementation is obtained. 
% Please keep the Author Summary between 150 and 200 words
% Use first person. PLOS ONE authors please skip this step. 
% Author Summary not valid for PLOS ONE submissions.   
%\section*{Author summary}

\linenumbers

% Use "Eq" instead of "Equation" for equation citations.
% }}}
\section{Introduction} % {{{

Since their inception, quantum computers were proposed as powerful tools for
the simulation of quantum systems~\cite{feynman1982simulating}. 
% Several 
% kinds of quantum systems have been simulated, like \cpnote{PONER ALGO ACA Y CITAR. 
% Te puedes inspirar en las introducciones de articulos que simulen sistemas cuanticos}. 
Being open quantum systems of fundamental~\cite{Zur91,RevModPhys.76.1267} and
practical~\cite{breuer2007theory} interest, there has been efforts
towards the simulation of the evolution of open quantum
systems~\cite{cleve,Zanetti,Xin,Wei}\cpnote{porque escogiste estas citas? Me parece qeu la ce cleve no está completa.}.
Such systems have been simulated because of their many applications, 
such as studying the emergence of multipartite entanglement~\cite{Andrea,Andrea_AD},
studying dissipative processes~\cite{Barreiro}
and modeling non-Markovian dynamics~\cite{Marsden}.
Among quantum systems, the simplest case is that of a qubit~\cite{chuangbook},
and withing them, the simplest class of channels that produce decoherence are
Pauli channels~\cite{geometry,Zbigniew,Davalos}. Indeed, they serve as
effective models for the noise affecting quantum devices~\cite{Flammia,Fawzi}.

To represent the algorithms implemented in quantum computers, either to
simulate a physical system or for some other purpose, one often uses a quantum
circuit~\cite{chuangbook}.  In this work, we shall also work with parametrized
quantum circuits, that is,  quantum circuits in which some of the operations
depend on variable parameters~\cite{cerezo}.  These circuits play an important
part in applications such as quantum machine learning~\cite{Benedetti} and
describing general quantum transformations dependent on parameters. Substantial
research has been devoted to enhancing the efficiency of these
circuits~\cite{Watanabe,Rasmussen}. 

We start by providing the definition of quantum channels, the general framework
used here, and multi-qubit Pauli channels in section \ref{sec: Pauli Channels}.
Our first objective is to present a quantum algorithm capable of simulating
Pauli channels on quantum computers; we do this in section \ref{sec: Circuit
for a Pauli Channel}, where we also demonstrate its implementation using IBM's
quantum computers for the particular case of single-qubit Pauli channels. 
Expanding beyond discrete Pauli channels, we introduce the concept of Pauli
dynamical maps, defined as a continuous parametrization of multi-qubit Pauli
channels.  Therefore, in section \ref{sec: 1PR Circuits} we shift our focus to
study parametrized quantum channels, aiming to adapt the algorithm developed
for channels to dynamical maps.  Furthermore, we contribute to the body of work
related to parametrized quantum circuits by establishing a theorem,
which  sets the mathematical conditions for the transformations
that can be done using a parametrized circuit with the condition that only a
controlled \cpnote{el caso general es controlado, correcto?} single-qubit
operation in the circuit may depend on the parameter.  Finally, in
section \ref{sec: 1PR circuit for a Pauli map}, we conclude about the Pauli
dynamical maps that fulfill the conditions of theorem \ref{theorem2}. 

% }}}
\section{Pauli channels and dynamical maps}  \label{sec: Pauli Channels} % {{{

% Intro  {{{
% \textbf{Lista de puntos:}
% \begin{itemize}
% \item \textbf{Circuit for a Pauli channel:}  Propose a circuit to simulate a Pauli channel on $n$ qubits. It works by creating a $2n$-qubit state on ancilla qubits.
% \item \textbf{Simulation:} Show the fidelities of simulating the circuit on a quantum computer for many one-qubit channels inside the tetrahedron.
% \item \textbf{For Pauli dynamical maps}: See how the circuit generalizes to parametrized channels and notice that many rotations are needed to create the $2n$-ancilla qubit state. \\
% \end{itemize}

In this section  we introduce the concept of quantum channels, focusing on a
specific type called Pauli channels.  Furthermore, we define Pauli dynamical
maps, which are curves of Pauli channels parametrized by a variable.
% }}}
\subsection{Quantum Channels} \label{subsec: Quantum Channels} % {{{


In quantum mechanics, a closed system's state is represented by a vector in a
Hilbert space $\mathcal{H}$.  The state's evolution is unitary and given by
Schrodinger's equation~\cite{Rieffel}.  However, in real-world situations,
quantum systems are usually open, which means that they interact with their
environment~\cite{Breuer}.  For instance, the system's state may become
entangled with the environment, leading to a loss of information about the
system's state over time.

To describe open systems, instead of state vectors, we use matrices $\rho$ that
act on $\mathcal{H}$.  These matrices are called density matrices, and they
include information about the system's interaction with its environment.  For a
density matrix $\rho$ to be physically valid, it must satisfy two conditions:
$\tr(\rho) = 1$ and it must be positive semi-definite, which is denoted as
$\rho \geq 0$~\cite{chuangbook}.


Knowing this, we can now define quantum channels.  Quantum channels are
operators $\mathcal{E}$ that can describe the evolution of open quantum
systems, such that $\rho \rightarrow \mathcal{E}(\rho)$.  Quantum channels are
the most general linear operations that a quantum system can undergo
independently of its past~\cite{zimansbook,cirac}.  These channels are
constructed based on three fundamental properties: linearity, trace
preservation, and complete positivity.

Linearity ensures that a quantum channel $\mathcal{E}$ maps any ensemble of
density matrices into the corresponding ensemble of their evolution.  The trace
preserving property is given by $\tr (\mathcal{E}[\rho]) = \tr (\rho) = 1$ and
guarantees that the quantum channel does not change the condition that
$\tr(\rho) = 1$.  Finally, the channel should also preserve the condition $\rho
\geq 0$, and a map that does this is called a positive map.  However,
positivity of $\mathcal{E}$ is not enough, and we actually require the more
restrictive condition of complete positivity.  Complete positivity means that
$\mathcal{E} \otimes \mathbb{I}_n$ is positive for any positive integer $n$
(where $\mathbb{I}_n$ is the $n\times n$ identity matrix).  This ensures that
even if the principal system is entangled with another system, applying
$\mathcal{E}$ to the principal system while doing nothing to the other one
still results in  a positive semidefinite state for the principal
system~\cite{chuangbook}. 

Given a quantum channel $\mathcal{E}$, the condition of trace preservation is
straightforward to verify but complete positivity is not as simple.  To test
complete positivity of a quantum channel, Jamiołkowski and
Choi~\cite{choi,jamil} developed a simple algorithm that exploits the
isomorphism between a channel $\mathcal{E}$ and the state $\mathcal{D} =
(\mathbb{I} \otimes \mathcal{E}) [|\Omega \rangle \langle  \Omega|]$, where
$|\Omega\rangle = 1/\text{dim}(\mathcal{H}) \sum_{i}^{\text{dim}(\mathcal{H})}
|i \rangle |i \rangle$ is a maximally entangled state between the original
system and an ancilla.  Remarkably, the map $\mathcal{E}$ is completely
positive if and only if $\mathcal{D}$ (also known as the Choi or dynamical
matrix of $\mathcal{E}$) is positive semidefinite.

% }}}
\subsection{Pauli Channels}  \label{subsec: Pauli Channels} % {{{

We have discussed the main features of quantum channels and 
now we turn our attention to a specific 
type of channels for $N$-qubit systems called Pauli channels.
First we will define these channels for single-qubit systems,
whose most general density matrix can be written as~\cite{chuangbook}:
\begin{equation}
\label{eq: Density Matrix}
\rho = \dfrac{1}{2} \sum_{\alpha=0}^{3} r_{\alpha} \sigma_{\alpha},
\end{equation}
with $\sigma_0 = \mathbb{I}$, and $\sigma_{1,2,3}$ the usual Pauli matrices.
The condition $\tr(\rho) = 1$ requires that $r_0 = 1$ while $\rho \geq 0$ 
implies that the remaining $r_{1,2,3}$ form
a vector $\vec{r}= (r_1,r_2,r_3)$ inside a unit sphere known as the Bloch sphere~\cite{Marinescu}.
That is, every possible density matrix for a one-qubit
system is uniquely associated with a point in a unit sphere. 

Given a one-qubit system described by $\rho$, 
a Pauli channel is defined as an operation that with probability $k_{\gamma}$
applies the Pauli matrix $\sigma_{\gamma}$ to
the system, for $\gamma = 0,1,2,3$~\cite{geometry}.
Mathematically, the Pauli channel is written in the following way:
\begin{eqnarray}
\label{eq: Pauli channel 1 qbit}
\mathcal{E}(\rho) = \sum_{\gamma=0}^3 k_{\gamma} \sigma_{\gamma} \rho \sigma_{\gamma},
\end{eqnarray} 
where the probabilities $k_{\gamma}$ of applying $\sigma_{\gamma}$
are non-negative real numbers such that 
$\sum_{\gamma} k_{\gamma} = 1$ (these conditions also ensure that the channel is 
trace preserving and completely positive).

Pauli channels are some of the 
most fundamental noise models in quantum information science~\cite{Terhal}. 
Some notable examples of Pauli channels are the following:
\begin{itemize}
\item \textbf{Bit Flip Channel:} This is a channel that with probability $1-p$ leaves the qubit as it is 
and with probability $p$ it applies the $\sigma_1$ matrix 
(which flips the basis states $|0\rangle$ and $|1\rangle$ of the qubit), and
so it is given by:
\begin{align*}
\mathcal{E}(\rho) = (1-p) \rho + p \sigma_1 \rho \sigma_1.
\end{align*}
Analogous channels exist using $\sigma_3$ (called the bit flip channel,
which has a probability $p$ of adding a relative phase $\pi$ to the state) or 
using $\sigma_2$ (called the phase flip channel, 
which has a probability $p$ of 
flipping the base states and also add a relative phase $\pi$).
\item \textbf{Depolarizing channel:} 
This channel has a probability $1-p$
of doing nothing to the qubit and a probability $p$ of converting it into the maximally mixed state $\dfrac{1}{2} \mathbb{I}$
and it can be written as:
\begin{equation}
\mathcal{E}(\rho) = (1-p)\rho + p \dfrac{1}{2} \mathbb{I} = \left(1 - \dfrac{3p}{4} \right) \sigma + \dfrac{p}{4} \sigma_1 \rho \sigma_1 + \dfrac{p}{4} \sigma_2 \rho \sigma_2+ \dfrac{p}{4} \sigma_3 \rho \sigma_3.
\end{equation} 
\end{itemize}

We can also see how an arbitrary Pauli channel acts on an arbitrary  
density matrix.
To do it, we substitute \eref{eq: Density Matrix} 
in \eref{eq: Pauli channel 1 qbit}:
\begin{equation}
\mathcal{E}(\rho) = \dfrac{1}{2}\sum_{\gamma,\alpha=0}^3 k_{\gamma} r_{\alpha} \sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma}.
\end{equation}
This can be simplified by using the following property of Pauli matrices:
\begin{equation}
\label{eq: propiedad-pauli}
\sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma} = A_{\alpha,\gamma} \sigma_{\alpha}, \;\;\;\;\; \text{with} \; A_{\alpha,\gamma} = \begin{pmatrix}
1 & 1 & 1 & 1\\
1 & 1 & -1 &-1 \\
1 & -1 & 1 & -1 \\
1 & -1 & -1 & 1
\end{pmatrix},
\end{equation}
which leads to
\begin{equation}
\label{eq: rho-transformada}
\mathcal{E}(\rho) = \dfrac{1}{2} \sum_{\alpha} \left(\sum_{\gamma} A_{\alpha, \gamma} k_{\gamma} \right) r_{\alpha} \sigma_{\alpha}.
\end{equation}
\eref{eq: rho-transformada} once again has the form of \eref{eq: Density Matrix}
but with components $\left( \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma} \right) r_{\alpha}$.
This gives us another way of understanding Pauli channels
as operations that take each component $r_{\alpha}$
of the density matrix and multiplies them
by $\sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}$, 
that is:
\begin{equation}
\label{eq: multipliers}
r_{\alpha}  \xrightarrow[\text{Channel}]{\text{Pauli}}  \tau_{\alpha} r_{\alpha} ,\;\; \tau_{\alpha} := \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}.
\end{equation}
Notice that $\tau_0 = 1$, which is a consequence of $\sum_{\gamma}k_{\gamma}=1$
and ensures that after the channel, the resulting density matrix still has trace one. 
Furthermore, reverting the definition of $\tau_{\alpha}$ by using that $A^{-1} = \dfrac{1}{4} A$, 
we get that $k_{\gamma} = \dfrac{1}{4} \sum_{\alpha} A_{\alpha,\gamma} \tau_{\alpha}$.
Then, using that $k_{\gamma} \geq 0$
we get the following conditions on the multipliers $\tau_{\alpha}$:
\begin{eqnarray}
\label{eq: conditions-tetrahedron}
&1+\tau_i -\tau_j - \tau_k \geq 0,  \;\;\; \text{for $i,j,k$ different numbers in $\{1,2,3\}$}, \\
&1+\tau_1 + \tau_2 + \tau_3 \geq 0.
\end{eqnarray}

These conditions imply that $(\tau_1,\tau_2,\tau_3)$
has to be inside a tetrahedron with
vertices $(1,1,1), (1,-1,-1),(-1,1,-1)$ and $(-1,-1,1)$. 
Therefore, the $\tau_{1,2,3}$ are numbers between 
$-1$ and $1$, which means that the components
$r_{\alpha}$ of the density matrix are always 
attenuated and possibly sign flipped.

Having defined the one qubit case,  we can now generalize to $N$ qubits.
In order to do it, we need to introduce the so-called \textit{Pauli strings}, defined as
\begin{eqnarray}
\label{eq: Pauli string}
\sigma_{\vec{\alpha}} = \sigma_{\alpha_1} \otimes \sigma_{\alpha_2}\otimes \cdots \otimes \sigma_{\alpha_N},
\end{eqnarray}
where $\vec{\alpha}$ denotes a multi-index $(\alpha_1, \cdots, \alpha_N)$
 and $\alpha_i \in \{0,1,2,3\}$. 
These operators form an orthogonal basis in the space of operators acting on $N$ qubits. 
 Similarly to the single-qubit case, the density matrix $\rho$ 
of a system of $N$ qubits can be written using Pauli strings as:
\begin{equation}
\label{eq:  Density matrix Nqbit}
\rho = \dfrac{1}{2^N} \sum_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}}.
\end{equation}
Then, just as before, we define a Pauli channel as a transformation that applies 
the operator $\sigma_{\vec{\gamma}}$ to $\rho$ with probability $k_{\vec{\gamma}}$
and is therefore described mathematically by:
\begin{equation}
\label{eq: pauli channel N-qubit}
\mathcal{E}(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}} \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{equation}
where just as before, $k_{\vec{\gamma}}$ are non-negative real numbers such 
that $\sum_{\vec{\gamma}} k_{\vec{\gamma}}=1$.

As in the one qubit case, Pauli channels for $N$ qubits 
attenuate the components $r_{\vec{\alpha}}$ of the density matrix.
This can be seen by substituting \eref{eq:  Density matrix Nqbit} in \eref{eq: pauli channel N-qubit}
and using the property of \eref{eq: propiedad-pauli}:
\begin{align*}
\mathcal{E}(\rho) &= \dfrac{1}{2^N} \sum_{\vec{\gamma},\vec{\alpha}} k_{\vec{\gamma}} r_{\vec{\alpha}} \sigma_{\vec{\gamma}} \sigma_{\vec{\alpha}} \sigma_{\vec{\gamma}} \\
& = \dfrac{1}{2^N} \sum_{\vec{\alpha}} \left( \sum_{\vec{\gamma}} {(A^{\otimes^N})}_{\vec{\alpha},\vec{\gamma}} \; k_{\vec{\gamma}} \right) r_{\vec{\alpha}} \sigma_{\vec{\alpha}},
\end{align*}
which means that applying the Pauli channel multiplies the 
components $r_{\vec{\alpha}}$ by $\tau_{\vec{\alpha}} := \sum_{\vec{\gamma}} {(A^{\otimes^N})}_{\vec{\alpha},\vec{\gamma}} k_{\vec{\gamma}}$.
% }}}
\subsection{Pauli Dynamical Maps} % {{{
\label{subsec: Pauli Dynamical Maps}


As seen in the last section, Pauli channels and in 
general quantum channels are discrete maps
that transform a density matrix $\rho$ into $\mathcal{E}(\rho)$.
However, we could also define a continuous set of 
channels $\varepsilon_p$ with $p$ a real parameter.

For the special case of Pauli channels, we define 
a Pauli dynamical map as a continuous parametrized 
curve drawn inside the set of Pauli channels and starting at the identity channel. 
Therefore, a Pauli dynamical map can be written as
\begin{eqnarray}
\label{eq: Pauli dynamical map}
\mathcal{E}_p(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}}(p) \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{eqnarray}
where $p$ is a parameter in an interval $[a,b]$ 
and $\mathcal{E}_p$ is a Pauli channel for every $p$, 
with $\mathcal{E}_a$ being the identity channel.

% }}}
% }}}
\section{Circuit for a Pauli Channel} % {{{
\label{sec: Circuit for a Pauli Channel}
% Intro {{{

In this section we propose a quantum circuit that simulates $N$-qubit Pauli
channels.  Moreover, we implement the circuit for $N=1$ on a quantum computer
and analyze the results using the diamond norm.
We find that close to the depolarizing channel, the general circuit simulator 
can implement such channels with the highest fidelity. 
% produce the highest 
% }}} 
\subsection{Description of the Circuit for a Pauli Channel} %{{{
\label{subsec: Description of the circuit}




% To design the circuit, we recall that a Pauli channel, as the one in
% \eref{eq: pauli channel N-qubit}, applies each Pauli operator
% $\sigma_{\vec{\gamma}}$ on $\rho$ with a probability $k_{\vec{\gamma}}$.
% Given this, it is easy to construct a quantum circuit that implements 
% a Pauli channel with the help of $2N$ ancilla qubits,
% see \fref{fig: circuit-pauli}.
% The general idea is to produce the probabilities $k_{\gamma}$ by creating the state
% \begin{eqnarray}
% \label{eq: state0}
% \sum_{\vec{\gamma}} b_{\vec{\gamma}} |\vec{\gamma} \rangle
% \end{eqnarray}
% in the ancilla qubits, 
% where $b_{\vec{\gamma}}$ are numbers such that $
% |b_{\vec{\gamma}}|^2 = k_{\vec{\gamma}}$.
% The $2N$-qubit state $|\vec{\gamma}\rangle$  is defined as $|\gamma_1 \rangle
% \cdots |\gamma_N\rangle$.

% {\color{orange} Cambiar por:  
To design the circuit that implements \eref{eq: pauli channel N-qubit}, we construct a state that 
includes the probabilities $k_{\gamma}$ on the ancilla qubits and subsequently
apply controlled Pauli operations on the main qubits.  The circuit that does
this is presented in \fref{fig: circuit-pauli}. 


\begin{figure} % {{{
\centering
\includegraphics{images/circuito_general.pdf}
\caption{{\bf Circuit for an $N$-qubit
Pauli channel on $N$ qubits.}
The circuit creates the state $\sum_{\vec{\gamma}} b_{\vec{\gamma}}|\vec{\gamma}\rangle$ 
on the $2N$ ancilla qubits denoted by $\tilde{q}$. }
\label{fig: circuit-pauli}
\end{figure} % }}}

The first part of the circuit involves the creation of the state
\begin{eqnarray}
\label{eq: state}
\text{Ancilla state =} 
\sum_{\vec{\gamma}} b_{\vec{\gamma}} |\vec{\gamma} \rangle
\end{eqnarray}
on the ancilla qubits, where $b_{\vec{\gamma}}$ are numbers such that $
{|b_{\vec{\gamma}}|}^2 = k_{\vec{\gamma}}$ and
the $2N$-qubit state $|\vec{\gamma}\rangle$ is defined as $|\gamma_1\rangle
\cdots |\gamma_N\rangle$.
When measured in the computational basis, the state given in \eref{eq: state}
collapses to $|\vec{\gamma}\rangle$ with a 
probability ${|b_{\vec{\gamma}}|}^2 = k_{\vec\gamma}$. 
The circuit in \fref{fig: circuit-pauli} uses this fact
to apply $\sigma_{\vec{\gamma}}$ on the main qubits
with a probability $k_{\vec\gamma}$ by using controlled operations 
conditioned on the state of the system being $|\vec{\gamma}\rangle$,
just as the Pauli channel is supposed to do.  
% 
% that apply $\sigma_{\vec{\gamma}}$ to the main qubits
% only if the ancilla qubits are in the state $|\vec{\gamma}\rangle$.
% 
% Therefore, the circuit from \fref{fig: circuit-pauli} 
% applies each operation $\sigma_{\vec{\gamma}}$ to the principal qubits 
% with a probability $k_{\vec{\gamma}}$, 
% just as a Pauli channel is supposed to do.  

% \cpnote{Evaluar si al final ponemos algo al respecto de este comentario}
% \cpnote{Del circuito, parece ue las fases de las bs gammas no omportan mucho (o nada). 
% Esa libertad la hemos considerado? De alguna manera colapsan curvas de las que
% hemos visto?} \tbnote{Sí, es una libertad que se tiene y he considerado y significa que hay muchas elecciones de $b_{\gamma}$ para un mismo canal.
% Es una de las varias cosas que complicaba determinar uno a uno qué canales se pueden hacer.}
% 

%}}}
\subsection{Simulation for one-qubit Pauli channels} % {{{
\label{subsec: Simulation for one-qubit Pauli channels}

For the particular case of a Pauli channel on one qubit, the circuit that
simulates it can be constructed as in \fref{fig: circuit-pauli-1},
which is a special case of \fref{fig: circuit-pauli}
but with all details  explicitly shown.
In said figure, the ancilla state
of \eref{eq: state} can be taken to be
$\sqrt{k_{00}} |00\rangle + \sqrt{k_{01}} |01\rangle + \sqrt{k_{10}} 
|10\rangle + \sqrt{k_{11}}|11\rangle$
and it is created on the ancilla qubits with the help of three rotations of angles
defined by the following equations:
\begin{align}
\label{eq:angle}
\cos\left(\dfrac{\theta_0}{2} \right) &= \sqrt{k_{00} + k_{01}},\\
\tan\left( \dfrac{\theta_1 + \theta_2}{2} \right) &= \sqrt{k_{01}/k_{00}}, \\
\tan\left( \dfrac{\theta_2 - \theta_1}{2} \right) &= \sqrt{k_{11}/k_{10}}.
\end{align}

\begin{figure} % {{{
\centering
\includegraphics{images/circuito_unqubit.pdf}
\caption{
{\bf One qubit Pauli channel circuit.} Circuit for a one-qubit Pauli channel,
which is a particular case of \fref{fig: circuit-pauli}.  Here we have two
ancilla qubits and we use three rotations
of angles given by \eref{eq:angle} to create the Ancilla State of
of \eref{eq: state} for the two ancilla qubits.
}
\label{fig: circuit-pauli-1} 
\end{figure} % }}}


% We took a sample of one-qubit Pauli channels and
% used the ibmq-lima quantum computer that IBM has available~\cite{Qiskit}
% to simulate them. For each of these channels, we used quantum process
% tomography~\cite{Qiskit, Chuang:1996} to obtain the 
% operator $\xi_I$ corresponding to the implementation of the
% circuit.  Then, we compared this operator with the ideal 
% channel $\xi_T$  we
% wanted to implement.  

We took a sample of one-qubit Pauli channels
and evaluated their implementation on IBM's
ibmq-lima quantum computer~\cite{Qiskit},
as shown in \fref{fig:fids}. 
For each of the channels sampled, we used 
quantum process tomography~\cite{Qiskit, Chuang:1996} to obtain the 
operator $\xi_I$ corresponding to the implementation of the
circuit in the quantum computer. 
Then, we compared $\xi_I$ with the theoretical 
operator $\xi_T$ of the Pauli channel we wanted to implement.
To see how close the operators $\xi_I$ and 
$\xi_T$ are, we shall use the
diamond distance~\cite{Aharonov,Wilde}, which is defined by
\begin{equation}
||\xi_I - \xi_T ||_{\diamond}  = \max_{\rho} || (\xi_I \otimes I) \rho - (\xi_T \otimes I) \rho ||_1,
\end{equation}
with $I$ the identity map,
$|| \cdot ||_1$ the trace norm and the maximization
done over all density matrices $\rho$.
The calculation of this norm is done using the semi-definite program from reference \cite{Watrous}.
When the two channels are the same,
the diamond distance has a value of $0$, while in the case that the channels
are completely distinguishable, the distance reaches its maximum value of $2$~\cite{Benenti}.
For the analysis done in \fref{fig:fids}, we define a sort of ``diamond fidelity'' as: 
\begin{equation}
f = 1 - \dfrac{1}{2} ||\varepsilon_I - \varepsilon_T ||_{\diamond},
\label{eq:diamond-fid}
\end{equation}
which ranges from $0$, when the channels have a maximum distance, to  $1$,
when they are exactly equal.

\begin{figure} % {{{
\centering
\begin{subfigure}{0.9\textwidth}
\begin{subfigure}{.666\textwidth}
\centering
\includegraphics[width=.95\columnwidth]{images/tetra-def.png}
\end{subfigure}%
\begin{subfigure}{.333\textwidth}
\includegraphics[width=.95\columnwidth]{images/corte1-2.png} \\
\includegraphics[width=.95\columnwidth]{images/corte2-2.png} \\
\end{subfigure}
\includegraphics[width=.322\columnwidth]{images/corte3-2.png}
\includegraphics[width=.322\columnwidth]{images/corte4-2.png}
\includegraphics[width=.322\columnwidth]{images/corte5-2.png}
\end{subfigure}%
\begin{subfigure}{0.1\textwidth}
\includegraphics[width=.8\columnwidth]{images/col-2.png} \\ [2ex]
\end{subfigure}
\caption{Results of the diamond fidelities as defined in \eref{eq:diamond-fid}
for a sample of Pauli channels in the tetrahedron.  Notice that channels close
to the center of the tetrahedron have high fidelities, while those close to the
borders do not.  Moreover, we show the results for cuts of the tetrahedron at
different values of $\tau_3$.}
\label{fig:fids}
\end{figure} % }}}

Finally, using the representation of Pauli channels in a tetrahedron as in
\eref{eq: conditions-tetrahedron}, we show in \fref{fig:fids} the diamond
fidelity defined by \eref{eq:diamond-fid} for the channels analyzed.  We can
see that channels close to the completely depolarizing channel (that is close
to the center of the tetrahedron) have a high $f$, while those close to unitary
channels have much lower $f$.  This is reasonable because quantum computers are
prone to errors that depolarize qubits, which isn't very problematic when
trying to simulate depolarization but it is when simulating unitary processes.
Moreover, the algorithm of \fref{fig: circuit-pauli-1} is not optimal for
unitary channels (that is, the channels corresponding to the vertices of the
tetrahedron).  These straightforward channels could be accomplished more
efficiently by simply applying the corresponding Pauli operation directly.
Nevertheless, due to its general design to accommodate any Pauli channel, the
algorithm employs numerous quantum gates even in such scenarios.


% }}}
% }}}
\section{One Parameter Circuits} % {{{
\label{sec: 1PR Circuits}


Just as Pauli channels, Pauli dynamical maps can be implemented using the circuit
of \fref{fig: circuit-pauli}. However, there is one difference: 
the state to be created on the ancilla qubits now 
depends on a parameter $p$, and it is represented by the expression:
\begin{eqnarray}
\label{eq: parametrized state}
\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle.
\end{eqnarray}
Thus, we temporarily shift our focus from Pauli
channels and dynamical maps to the general problem of 
creating a circuit to generate a curve of
states like the one described in \eref{eq: parametrized state}.

In general, producing this curve of states for $N$ qubits will require
many rotations parametrized by $p$,
such as the three rotations used for the ancilla
qubits in \fref{fig: circuit-pauli-1}.
However, it would be preferable to achieve the same effect using only one parametrized rotation. 
This would allow us to interpret said rotation 
as a knob that smoothly traverses the curve of states.
Consequently, we are faced with the question of which curves of states, 
such as the one described in \eref{eq: parametrized state}, 
can be produced using just a single parametrized rotation. 
To clarify this, we provide the following definition 
for a circuit with one parametrized rotation.

\begin{definition}{\textbf{1-Parameter Rotation Circuit:}}
A 1-Parameter Rotation (1PR) circuit is a parametrized quantum
circuit that includes only one gate dependent on a parameter $p$.
Moreover, the parametrized gate is a one-qubit rotation about any axis,
whether controlled or not.
\end{definition}

Based on this definition, we aim to determine which curves of 
states can be generated using 1PR circuits. 
To accomplish this, we begin by proving that all 1PR circuits have 
the form depicted in \fref{fig:1PR-circuit},
where the parametrized rotation is around $\sigma_3$ and
is applied to the last qubit.

\begin{figure} % {{{
\centering
\includegraphics{images/OPR-circuit.pdf}
\caption{\textbf{General form of a 1PR circuit}.
Any 1PR circuit can be transformed into this form,
where the rotation on the last qubit
can be controlled or not by any of the other qubits.
$A$ and $B$
are $N$-qubit gates that do not depend on the parameter $p$ and
$s= s(p)$ is a function of the parameter.
}
\label{fig:1PR-circuit}
\end{figure} % }}}

\begin{theorem}
An $N-$qubit 1PR circuit can always be transformed 
into the form shown in \fref{fig:1PR-circuit}.
\end{theorem}
\textbf{Proof:} 
First, we observe that according to the
definition, a 1PR circuit always consists of an operation $B$ followed 
by the parametrized rotation and then another operation $A$, 
where $A$ and $B$ are not parametrized.

Next, we note that it is not necessary to consider rotations about an arbitrary axis,
as a rotation about any axis $\hat{n}$ parameterized by $p$
can be transformed into a rotation about $\sigma_3$ without introducing 
gates that depend on $p$. To see this, consider the rotation $R_{\hat{n}}(2s)$, where $2s$ 
is a function of $p$ (the factor of 2 is for convenience later on) 
and $\hat{n} = (n_1,n_2,n_3)$ represents the rotation axis. 
We can express $\hat{n}$ as $(\sin \theta \cos \phi, \sin \theta \sin \phi, \cos \theta)$, 
where $\theta$ and $\phi$ are fixed angles dependent on $\hat{n}$. 
The rotation can then be rewritten as follows:
\begin{eqnarray}
R_{\hat{n}}(2s) = R_{\sigma_3}(\phi) R_{\sigma_2}(\theta) R_{\sigma_3}(2s) R_{\sigma_2}(-\theta) R_{\sigma_3}(-\phi).
\end{eqnarray}
Since the angles $\theta$ and $\phi$ do not depend on the parameter $p$,
any 1PR circuit can be transformed into a circuit where the parametrized
 rotation is around $\sigma_3$ instead of an arbitrary axis. 
Moreover, without loss of generality, we can choose the last qubit as the
target qubit for the rotation, since if it weren't, we could use
swap gates to move the rotation
to the first qubit without adding gates
that depend on $p$. 

Therefore, a 1PR circuit can be transformed such
that the rotation is around $\sigma_3$ and is applied to the last qubit 
(possibly controlled by other qubits), 
resulting in the form depicted in \fref{fig:1PR-circuit}. 
$\blacksquare$ \\
$\;$\\

With the aid of this theorem, we can now determine the curves
of states of $N$ qubits that can be generated using a 1PR circuit. 
This result is stated in the following theorem.

\begin{theorem}
\label{theorem2}
Consider a 1PR circuit of $N$ qubits parametrized by $p$
and denote by $U$ the operator it implements on this system. 
Then, for every $j \in \{0, 1, \cdots, 2^N-1\}$, 
we have that:
\begin{align*}
U|j\rangle = e^{is(p)} |a^j\rangle + e^{-is(p)} |b^j\rangle + |c^j\rangle
\end{align*}
with $s(p)$ some function of $p$,  $|a^j\rangle ,|b^j\rangle, |c^j\rangle$ orthogonal states and $\langle a^j| a^j\rangle + \langle b^j| b^j\rangle + \langle
c^j|c^j \rangle = 1$.
\end{theorem}
\textbf{Proof:} 
We can conclude from theorem 1 that $U=ARB$,
where $A$ and $B$ are unitary matrices and $R$ is a $\sigma_3$ rotation of angle $2s$
applied to the last qubit and controlled by some of the other ones. 

First, applying $B$ to $|j\rangle$ results in $B|j\rangle = B_{0,j} |0\rangle + B_{1,j} |1 \rangle + \cdots + B_{2^n-1,j}|2^n-1\rangle$,
with $B_{i,j}$ the entries of matrix $B$.
This can be rewritten by separating last qubit from the other $N-1$:
\begin{equation}
B|j\rangle = \sum_{k=0}^{2^{N-1}-1} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right).
\end{equation}
After the operator $B$, the circuit applies the  controlled rotation $R$.
To simplify the analysis, we separate the states of
the first $N-1$ qubits into those that fulfill the control conditions of the rotation
(which we denote as the set $\mathcal{C}$)
and those that do not, and write it as
\begin{align}
B|j\rangle = 
   \sum_{k \in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle 
                                     + B_{2k+1,j} |k \rangle |1\rangle  \right) 
   + \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle  
                                      + B_{2k+1,j} |k \rangle |1\rangle  \right).
\end{align}

Then, the rotation $R$ will only affect the states on the first sum (since they fulfill the control conditions)
and not the others. Therefore,  
remembering that a $\sigma_3$ rotation acts by adding a phase $e^{-is(p)}$ to $|0\rangle$
and a phase $e^{is(p)}$ to $|1\rangle$, we have that,
% \begin{small}
% \begin{eqnarray}
% &e^{-is} \sum_{k \in \mathcal{C}} B_{2k,j} |k\rangle |0\rangle + e^{is} \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |1 \rangle 
% + \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle |0\rangle + B_{2k+1} |k\rangle |j \rangle \right)\\
% & \qquad = e^{-is} \vec{b'}_j + e^{is} \vec{a'}_j + \vec{c'}_j,
% \end{eqnarray}
% \end{small}
% test
\begin{align}
RB|j\rangle& = e^{-is(p)} \sum_{k \in \mathcal{C}} B_{2k,j} |k\rangle |0\rangle + e^{is(p)} \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |1\rangle 
+ \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right) \nonumber \\
& = e^{-is(p)} |\tilde{b}^{j}\rangle + e^{is(p)} |\tilde{a}^j\rangle + |\tilde{c}^j\rangle
\end{align}
where we defined
\begin{align*}
|\tilde{a}^j \rangle &= \sum_{k \in \mathcal{C}} B_{2k,j}|k\rangle|0\rangle,\\
|\tilde{b}^j\rangle &= \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |0 \rangle,\\
|\tilde{c}^j\rangle &= \sum_{k \not\in \mathcal{C}}\left( B_{2k,j} |k\rangle|0\rangle+ B_{2k+1,j} |k \rangle |1\rangle  \right).
\end{align*}
These states are clearly orthogonal because they are each linear combinations of different 
orthogonal states of the computational basis. 
Moreover, they satisfy  $\langle a^j| a^j\rangle + \langle b^j| b^j\rangle + \langle c^j| c^j\rangle = 1$ because this quantity is the squared norm of the $j$th column of $B$, 
which is unitary.

Finally, after having applied the rotation, the circuit applies gate $A$, 
so that the result is given by:
\begin{eqnarray}
U|j\rangle = ARB|j\rangle = e^{-is(p)} A |\tilde{a}^j\rangle + e^{is(p)} A |\tilde{b}^j\rangle + A |\tilde{c}^j\rangle = e^{-is(p)} |a^j\rangle + e^{is(p)} |b^j\rangle + |c^j\rangle,
\end{eqnarray}
where $|a^j\rangle = A |\tilde{a}^j\rangle, |b^j\rangle = A |\tilde{b}^j\rangle, |c^j\rangle = A |\tilde{c}^j\rangle$ are still orthogonal
states that satisfy $\langle a| a\rangle + \langle b| b\rangle + \langle c| c\rangle = 1$ because $A$ is unitary. $\blacksquare$  \\
 $\;$ \\

This theorem implies that when starting from the state $|0\rangle$ 
or any other initial state, the only possible curves of states that can be 
created using a 1PR circuit are of the following form:
\begin{equation}
|\eta(p)\rangle = |c\rangle + e^{is(p)}|a\rangle + e^{-is(p)} |b\rangle,
\label{eq:curve-states}
\end{equation}
with conditions defined by the equations: 
\begin{equation}
\langle a| a\rangle + \langle b| b\rangle + \langle c| c\rangle = 1,  \quad
\langle a |b\rangle =
\langle a |c\rangle =
\langle b |c\rangle = 0.
\label{eq:conditions-vecs}
\end{equation}
% \cpnote{Es un poco confusa la notacion. Hablas de la norma de a con $|a|$, pero ahi parece
% que $a$ es un vector. Sugiero cambiar a $\langle a | a \rangle$ o algo asi sin cargar mucho
% la notacion. } \tbnote{Va, concuerdo, listo}
% \cpnote{Tambien siento qeu las palabras son un poco raras. Sugiero pasarlo por Chatgpt y 
% luego tunearlo (todo este parrafo). Avisame cuando quede eso!} \tbnote{Ya}

Moreover, it is possible to construct a 1PR circuit to generate any given curve of 
states described by \eref{eq:curve-states}. 
One approach to achieve this is by utilizing the circuit 
depicted in \fref{fig:1PR-circuit}, 
with the parametrized rotation $R$ applied to the last qubit controlled by all the 
other qubits. The operators $A$ and $B$ can be defined as follows:
\begin{align*}
&B|0\rangle = \sqrt{\langle a | a \rangle} |2^{N}-1 \rangle + \sqrt{\langle b | b \rangle} |2^{N}-2\rangle + \sqrt{\langle c |c \rangle} |2^N-3\rangle, \\
&A|2^N-1 \rangle = \frac{1}{\sqrt{\langle a | a \rangle}} |a\rangle,\; A|2^{N}-2\rangle = \frac{1}{\sqrt{\langle b | b \rangle}}|b\rangle, \; A|2^{N}-3\rangle = \frac{1}{\sqrt{\langle c | c \rangle}}|c\rangle.
\end{align*}
The remaining part of the operators $A$ and $B$ can be defined
in any arbitrary manner as long as they are unitary.
By starting from the initial state $|0\rangle$ and 
applying the circuit shown in \fref{fig:1PR-circuit}, straightforward calculations 
lead us to obtain the resulting curve of states described in \eref{eq:curve-states}.

To see it, we can rewrite the expression of $B|0\rangle$ by 
separating the first $N-1$ qubits from the last one:
$$B|0\rangle = \sqrt{\langle a | a \rangle} |2^{N-1}-1\rangle |1\rangle + \sqrt{\langle b | b \rangle} |2^{N-1}-1\rangle |0\rangle + \sqrt{\langle c | c \rangle} |2^{N-1}-2\rangle |1\rangle.$$
Since the parametrized rotation $R$ is controlled by all the first $N-1$ qubits, it only applies to the first two terms of $B|0\rangle$. As a result, we obtain:

$$
RB|0\rangle =\sqrt{\langle a | a \rangle} e^{is(p)} |2^{N-1}-1\rangle |1\rangle + \sqrt{\langle b | b \rangle} e^{-is(p)} |2^{N-1}-1\rangle |0\rangle + \sqrt{\langle c | c \rangle} |2^{N-1}-2\rangle |1\rangle.
$$
Finally, applying the defined operator $A$ to this state yields the desired result.
 
%Therefore, from this theorem we conclude that
%the kind of curves of states that can be created
%using a 1PR circuit are always of the form
%\begin{align*}
%|b(p)\rangle= e^{is} \vec{a} + e^{-is} \vec{b} + \vec{c},
%\end{align*}
%where $s$ is a function of $p$, $\vec{a},\vec{b},\vec{c}$ are orthogonal vectors and
%$|\vec{a}|^2+  |\vec{b}|^2 + |\vec{c}|^2 = 1$.
%%\textbf{Puntos:}
%\begin{itemize}
%\item As said before, to implement a Pauli dynamical map, 
%we need to create the parametrized $2n$-qubit state 
%$\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle$ on the ancilla qubits.
%\item However, creating this state will in general require many rotations parametrized by $p$. 
%For example, for the case of a Pauli dynamical map on 1 qubit, 
%the parametrized state of the $2$ ancilla qubits in general requires $3$ parametrized rotations and can be constructed as follows: (poner circuito).\\
%In general, to create a parametrized state on $2n$ ancilla qubits will require
%$2n-1$ rotations parametrized by $p$.
%\item How can we reduce the amount of parametrized rotations used?
%\item \textbf{1PR Circuit:} Define an 1PR circuit (a circuit with one parametrized rotation)
%\item \textbf{Theorem about 1PR circuits:} \textit{An 1PR circuit on $n$ qubits with parameter $p$ always has an operator of the form:}
%\begin{eqnarray}
%U = (\vec{v}_0| \vec{v}_1| \cdots| \vec{v}_{2^n-1})
%\end{eqnarray}
%\textit{where $s = s(p)$ and the column vectors are $\vec{v}_j = e^{is} \vec{a}_j + e^{-is} \vec{b}_j + \vec{c}_j$, with $\vec{a}_j, \vec{b}_j, \vec{c}_j$ orthogonal vectors and $|\vec{a}_j|^2 + |\vec{b}_j|^2 + |\vec{c}_j|^2 = 1$.}
%\item \textbf{Proof:} La prueba está dentro de las ``Cosas-Escritas-Antes'', 
%aunque se puede y debe achicar bastante.
%\end{itemize}
% }}}
\section{1PR circuit for a Pauli map} % {{{
\label{sec: 1PR circuit for a Pauli map}

We can now use the previous results to conclude directly which Pauli dynamical maps
can be implemented with a 1PR circuit.
{\color{red} Given the condition of theorem \ref{theorem2}, the curve of states of \eref{eq: parametrized state}  needed 
to implement the map
has to be constructed with only one parametrized rotation.}
\cpnote{no entiendo esta frase} 
\tbnote{Si, no está bien escrita. Cambiar por:}
{\color{purple} For this, the curve of states of \eref{eq: parametrized state} 
has to be constructed with only one parametrized rotation,
so it has to satisfy the conditions of theorem \ref{theorem2}.
}
Therefore, this implies that the the map
\begin{eqnarray}
\varepsilon_p(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}}(p) \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{eqnarray}
can be implemented  if there are numbers $\beta_{\vec{\gamma}}(p)$ such that $|\beta_{\vec{\gamma}}(p)|^2 = k_{\vec{\gamma}}(p)$ and
\begin{eqnarray}
\label{eq:vec}
\sum_{\vec{\gamma}} \beta_{\vec{\gamma}}(p) |\vec{\gamma}\rangle = |c\rangle +  e^{is(p)} |a\rangle + e^{-is(p)}|b\rangle,
\end{eqnarray}
where $|a\rangle,|b\rangle,|c\rangle$ fulfill
the conditions of \eref{eq:conditions-vecs}.

For the particular case of one qubit, we can show some examples of Pauli
dynamical maps implementable with a 1PR circuit, which are plotted in
\fref{fig:curves1}. 
The examples we show include some the most common maps: the bit flip, phase flip, bit-phase flip and depolarizing.
However, we also include the parabolic dynamical map,
defined in \eref{eq:parab} and shown in \fref{fig:curves1}.
This map traces a parabola inside the tetrahedron connecting two of its vertices
and it describes a frontier in the tetrahedron between Pauli channels
that are reachable by Lindbladian dynamics and those that are not~\cite{Davalos}.

\begin{figure} % {{{
\captionsetup[subfigure]{justification=centering}
\centering
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width=.9\linewidth]{images/curvas.png}
   \caption{}
  \label{fig:curves1}
\end{subfigure}%
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width=.9\linewidth]{images/curvas-azar.png}
  \caption{}
  \label{fig:curves2}
\end{subfigure}
\caption{{\bf Some Pauli dynamical maps that can be implemented with a 1PR circuit.}
The curves painted in these tetrahedrons
represent Pauli dynamical maps that can be implemented with 1PR circuits.
(a) shows the dynamical maps mentioned in the main 
text, which are: depolarizing (purple), bit flip (blue),
phase flip (green), bit-phase flip (red)
and parabolic (orange).
(b) shows dynamical maps selected at random that can be implemented with 1PR 
circuits.}
\label{fig:curves}
\end{figure} % }}}


\begin{itemize}
\item \textbf{Depolarizing:} This dynamical map is given by
\begin{align*}
\varepsilon_p(\rho) = (1-3p/4) \rho + (p/4) \sigma_1 \rho \sigma_1 + (p/4) \sigma_2 \rho \sigma_2 + (p/4) \sigma_3 \rho \sigma_3,
\end{align*}
with $p \in [0,1]$. 
Therefore, the curve of states $|\beta(p)\rangle$ needed on the ancilla
qubits is such that ${|\beta_0(p)|}^2= (1-3p/4)$, ${|\beta_1(p)|}^2 =
{|\beta_2(p)|}^2 = {|\beta_3(p)|}^2 = p/4$.  Then, taking the $\beta_j$ to be
real, the curve of states can be 
\begin{align*}
|\beta(p) \rangle = \sqrt{1-3p/4} |00\rangle + \sqrt{p/4} |01\rangle + \sqrt{p/4} |10 \rangle  + \sqrt{p/4} |11\rangle.
\end{align*}
This state can be rewritten as:
\begin{align*}
|\beta(p)\rangle =& \; e^{is} \left( \dfrac{1}{2} |00\rangle - \dfrac{i}{2\sqrt{3}} |01\rangle 
      - \dfrac{i}{2\sqrt{3}} |10 \rangle - \dfrac{i}{2\sqrt{3}} |11\rangle \right) \\
& + e^{-is} \left( \dfrac{1}{2} |00\rangle + \dfrac{i}{2\sqrt{3}} |01\rangle 
      + \dfrac{i}{2\sqrt{3}} |10\rangle + \dfrac{i}{2\sqrt{3}} |11 \rangle \right),
\end{align*}
with $\sin s = \sqrt{3p/4}$.
We can see that this curve satisfies the conditions of \eref{eq:conditions-vecs}, meaning that it can be created with a 
1PR circuit.

\item \textbf{Parabolic dynamical map:} We define the parabolic dynamical map as:
\begin{eqnarray}
\epsilon(\rho) = \dfrac{1}{4} {(1-p)}^2  \rho + \dfrac{1}{4} (1-p^2) \sigma_1 \rho \sigma_1 + \dfrac{1}{4} (1-p^2) \sigma_2 \rho \sigma_2 + \dfrac{1}{4} {(1+p)}^2 \sigma_3 \rho \sigma_3,
\label{eq:parab}
\end{eqnarray}
with $p \in [-1,1]$. 
If we take the $\beta_j$ to be real,
the curve of states needed on the ancilla qubits can be:
\begin{eqnarray}
|\beta(p)\rangle = \dfrac{1}{2} (1-p) |00\rangle + \dfrac{1}{2} \sqrt{1-p^2} |01\rangle +  \dfrac{1}{2} \sqrt{1-p^2} |10\rangle +  \dfrac{1}{2}(1+p) |11\rangle.
\end{eqnarray}
This can be rewritten as
\begin{align*}
|\beta(p)\rangle =&\; \left( \dfrac{1}{2}|00\rangle + \dfrac{1}{2} |11\rangle \right) + e^{is} \left( \dfrac{i}{4}|00\rangle + \dfrac{1}{4} |01\rangle + \dfrac{1}{4} |10\rangle - \dfrac{i}{4} |11\rangle \right) \\
& + e^{-is}  \left( \dfrac{-i}{4} |00\rangle + \dfrac{1}{4} |01\rangle + \dfrac{1}{4} |10\rangle + \dfrac{i}{4} |11\rangle \right),
\end{align*}
with $\sin s = p$, so that
this map fulfills the conditions of  \eref{eq:conditions-vecs}.


\item \textbf{Bit flip map:} 
This dynamical map is defined as
\begin{align*}
\varepsilon_p(\rho) = (1-p)\rho + p\sigma_1 \rho \sigma_1,
\end{align*}
for $p \in [0,1]$. 
In particular, if we take the $\beta_j$ to be real,
we need to create the curve of states:
\begin{align*}
|\beta(p)\rangle = \sqrt{1-p} |00\rangle +\sqrt{p} |01\rangle.
\end{align*}
This can be rewritten as
\begin{align*}
|\beta(p) \rangle = e^{is}  \left(\frac{1}{2} |00\rangle - \dfrac{i}{2} |01\rangle \right) + e^{-is} \left( \frac{1}{2} |00\rangle + \frac{i}{2} |01\rangle \right),
\end{align*}
with $\sin s= \sqrt{p}$.
Therefore, we can see that the curve satisfies the conditions of  \eref{eq:conditions-vecs} 
and it can be created with a 1PR circuit.
Note that in this case we actually only need one ancilla qubit
since the state $|\beta(p)\rangle$ is only two dimensional.

The exact same thing can be done
for the phase flip and bit phase flip dynamical maps by
changing $\sigma_1$ to
$\sigma_3$ and $\sigma_2$ respectively.
For example, the bit phase flip map was implemented in \cite{Andrea, Andrea_4qb} 
using an optical arrangement, and  it was indeed done 
by varying only one angle that depends on the parameter $p$ (the angle of a half waveplate).

\end{itemize}

Furthermore, we can construct other examples of 
Pauli dynamical maps such that they
can be implemented with a 1PR circuit.
To do it, we only need to choose the three states $|a\rangle$, $|b\rangle$, $|c\rangle$
that satisfy the conditions of  \eref{eq:conditions-vecs}.
For example, this can be done systematically for the case of curves of states of two qubits
(that is, for Pauli dynamical maps of one qubit)
with the following procedure:
\begin{itemize}
\item[1.] We first choose the norms $|a|$, $|b|$, $|c|$
such that $\langle a| a\rangle + \langle b| b\rangle + \langle c| c\rangle = 1$. 
This can be done by selecting two angles
$\mu \in [0, \pi/2]$, $\nu \in [0,\pi/2]$ and defining:
\begin{align*}
|a| = \sin \nu \cos \mu, \; |b| = \sin \nu \sin \mu , \; |c| = \cos \nu.
\end{align*}
\item[2.] We define $|a'\rangle = |a| |0\rangle$, $|b'\rangle = |b| |1\rangle$, $|c'\rangle = |c| |2\rangle$.
\item[3.] 
Finally, we choose a unitary matrix $V$ with the condition that its first
row is equal to $e^{i\theta} (|a|,|b|,|c|,0)$
with $\theta$ a uniform random phase.
That way, we can define $|a\rangle = V |a'\rangle$, $|b\rangle = V |b'\rangle$, $|c\rangle = V |c'\rangle$
and since $V$ is unitary, these unprimed vectors will fulfill the conditions of
\eref{eq:conditions-vecs}\cpnote{aun no construimos la $V$ asi que aun no es
unitaria. Aclarame ese punto y le sigo al resto del parrafo}.
Furthermore, the form of the first row ensures that the dynamical map begins at the identity,
since it implies that when $s=0$, the 
state created in \eref{eq:vec}
is
$|a\rangle + |b\rangle + |c\rangle = e^{i \theta} |0\rangle$,
which  corresponds with applying the identity channel.
Next, construct three vectors $\vec{w}_1 , \vec{w}_2, \vec{w}_3$ orthogonal to
the first row using the Gram-Schmidt process.  Then select random complex
numbers $r_1, r_2, r_3$ such that $|r_1|^2 + |r_2|^2 + |r_3|^2 = 1$ and define
the second row of $V$ to be $r_1 \vec{w}_1 + r_2 \vec{w}_2 + r_3 \vec{w}_3$.
Once the first two rows are chosen, use Gram-Schmidt to find two vectors
$\vec{v}_1, \vec{v}_2$ orthogonal to 
them and similarly define the third row as $q_1 \vec{v}_1+ q_2 \vec{v}_2$
with $|q_1|^2 + |q_2|^2$ and $q_1,q_2$
selected at random. 
Finally, there is only one choice for the fourth row so that it is 
orthonormal to the first three
and a random phase can be given to it.
\end{itemize}

Following this procedure for random
angles and unitary matrices $V$, 
we plot four Pauli dynamical maps  selected at random
that can be implemented with a 1PR circuit in \fref{fig:curves2}.

% }}}

\section{Conclusion} % {{{

\cpnote{Reitera. Dale a lo qeu discutimos el espacio. a lo de la decoherencia nota
que no lo tomamos como un resultado importante. Aca le das mucho mas espacio 
del que croe que merece. Inspirate en la intro. }


{\color{purple}
In this work, we found a quantum algorithm for 
simulating Pauli channels in $N$-qubit systems and
generalized it to Pauli dynamical maps.
We observed that the fidelity of 
simulating single-qubit Pauli channels on one of IBM's quantum computers
was highest for those closest to the totally depolarizing channel and fell off close to unitary channels,
which was attributed to the current limitations of quantum computers.
Additionally, when working with Pauli dynamical maps,
we determined in theorem \ref{theorem2} the general mathematical conditions
under which a parametrized quantum circuit requires only one single-qubit rotation dependent on the parameter.

Therefore, this work presents another example of the current
exploration into simulating open quantum
systems in quantum computers,
and we observe the big effect that the error of quantum computers have
on these simulations.
On the other hand, the result
of theorem \ref{theorem2}
shows what can be done with the condition of using only one
parametrized rotation and
can be applied to any quantum algorithm that requires parametrized circuits,
such as those used for quantum machine learning.
}



% }}}



%\section{Supporting information} % {{{


% Include only the SI item label in the paragraph heading. Use the \nameref{label} command to cite SI items in the text.
% \paragraph*{S1 Fig.}
% \label{S1_Fig}
% {\bf Bold the title sentence.} Add descriptive text after the title of the item (optional).
% 
% \paragraph*{S2 Fig.}
% \label{S2_Fig}
% {\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% 
% \paragraph*{S1 File.}
% \label{S1_File}
% {\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% 
% \paragraph*{S1 Video.}
% \label{S1_Video}
% {\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% 
% \paragraph*{S1 Appendix.}
% \label{S1_Appendix}
% {\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% 
% \paragraph*{S1 Table.}
% \label{S1_Table}
% {\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% }}}

\section{Acknowledgments} % {{{
Support by projects CONACyT 285754, and UNAM-PAPIIT IG101421 is acknowledged. 


\nolinenumbers

% }}}
% Biblbiografia {{{
% Either type in your references using
% \begin{thebibliography}{}
% \bibitem{}
% Text
% \end{thebibliography}
%
% or
%
% Compile your BiBTeX database using our plos2015.bst
% style file and paste the contents of your .bbl file
% here. See http://journals.plos.org/plosone/s/latex for 
% step-by-step instructions.
% 
%\begin{thebibliography}{10}
%
%\bibitem{bib1}
%Conant GC, Wolfe KH.
%\newblock {{T}urning a hobby into a job: how duplicated genes find new
%  functions}.
%\newblock Nat Rev Genet. 2008 Dec;9(12):938--950.

%\bibitem{bib2}
%Ohno S.
%\newblock Evolution by gene duplication.
%\newblock London: George Alien \& Unwin Ltd. Berlin, %Heidelberg and New York:
%  Springer-Verlag.; 1970.

%\bibitem{bib3}
%Magwire MM, Bayer F, Webster CL, Cao C, Jiggins FM.
%\newblock {{S}uccessive increases in the resistance of {D}rosophila to viral
%  infection through a transposon insertion followed by a {D}uplication}.
%\newblock PLoS Genet. 2011 Oct;7(10):e1002337.
%
%\end{thebibliography}
\tbnote{Poner la bibliografía como ellos dicen (copiarla toda aquí en lugar de ponerla en un archivo .bib)}
\bibliography{Bibliography}

% }}}
\newpage
\appendix
%\input{Cosas-Escritas-Antes}


\end{document}
