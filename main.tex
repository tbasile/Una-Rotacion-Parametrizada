\documentclass[10pt,letterpaper]{article} % {{{
\usepackage[top=0.85in,left=2.75in,footskip=0.75in]{geometry}
\usepackage{amsmath,amssymb}
% Use adjustwidth environment to exceed column width (see example table in text)
\usepackage{changepage}

% textcomp package and marvosym package for additional characters
\usepackage{textcomp,marvosym}
\usepackage{subcaption}

% cite package, to clean up citations in the main text. Do not remove.
\usepackage{cite}

% Use nameref to cite supporting information files (see Supporting Information section for more info)
\usepackage{nameref,hyperref}

% line numbers
\usepackage[right]{lineno}

% ligatures disabled
\usepackage[nopatch=eqnum]{microtype}
\DisableLigatures[f]{encoding = *, family = * }

% color can be used to apply background shading to table cells only
\usepackage[table]{xcolor}

% array package and thick rules for tables
\usepackage{array}

% create "+" rule type for thick vertical lines
\newcolumntype{+}{!{\vrule width 2pt}}

% create \thickcline for thick horizontal lines of variable length
\newlength\savedwidth
\newcommand\thickcline[1]{%
  \noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
  \cline{#1}%
  \noalign{\vskip\arrayrulewidth}%
  \noalign{\global\arrayrulewidth\savedwidth}%
}

% \thickhline command for thick horizontal lines that span the table
\newcommand\thickhline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
\hline
\noalign{\global\arrayrulewidth\savedwidth}}


% Remove comment for double spacing
%\usepackage{setspace} 
%\doublespacing

% Text layout
\raggedright
\setlength{\parindent}{0.5cm}
\textwidth 5.25in 
\textheight 8.75in

% Bold the 'Figure #' in the caption and separate it from the title/caption with a period
% Captions will be left justified
\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}
\renewcommand{\figurename}{Fig}
\renewcommand{\succ}{\textrm{succ}}

\newcommand{\fref}[1]{Fig.~\ref{#1}}
\newcommand{\eref}[1]{eq.~(\ref{#1})}
% Use the PLoS provided BiBTeX style
\bibliographystyle{plos2015}

% Remove brackets from numbering in List of References
\makeatletter
\renewcommand{\@biblabel}[1]{\quad#1.}
\makeatother



% Header and Footer with logo
\usepackage{lastpage,fancyhdr,graphicx}
\usepackage{epstopdf}



\usepackage[english]{babel}
\usepackage{graphicx,helvet}
\usepackage{color}
\usepackage{url}
\usepackage{amssymb}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage[inline]{showlabels}
\usepackage{bbm,bm}
\usepackage{soul}
\usepackage{amsfonts}
\usepackage{showlabels}

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{quantikz}

\usepackage[draft,inline,nomargin]{fixme} \fxsetup{theme=color}
\FXRegisterAuthor{cp}{acp}{\color{blue}CP}
\FXRegisterAuthor{tb}{ttb}{\color{green}TB}




%\pagestyle{myheadings}
\pagestyle{fancy}
\fancyhf{}
%\setlength{\headheight}{27.023pt}
%\lhead{\includegraphics[width=2.0in]{PLOS-submission.eps}}
\rfoot{\thepage/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrule}{\hrule height 2pt \vspace{2mm}}
\fancyheadoffset[L]{2.25in}
\fancyfootoffset[L]{2.25in}
\lfoot{\today}

%% Include all macros below

\newcommand{\lorem}{{\bf LOREM}}
\newcommand{\ipsum}{{\bf IPSUM}}
\DeclareMathOperator{\tr}{tr}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}

%% END MACROS SECTION

% }}}
\begin{document}
% Titulo, afiliacion, abstract  {{{
\vspace*{0.2in}

% Title must be 250 characters or less.


\begin{flushleft}
{\Large
\textbf\newline{Title of submission to PLOS journals} % Please use "sentence case" for title and headings (capitalize only the first word in a title (or heading), the first word in a subtitle (or subheading), and any proper nouns).
}
\newline
% Insert author names, affiliations and corresponding author email (do not include titles, positions, or degrees).
\\
Tomás Basile\textsuperscript{1\Yinyang},
Carlos Pineda\textsuperscript{2*\Yinyang},
\\
\bigskip
\textbf{1} Facultad de Ciencias. Universidad Nacional Autónoma de México, Ciudad de México 01000, Mexico
\\
\textbf{2} Instituto de Física, Universidad Nacional Autónoma de México, Ciudad de México 01000, México
\\
\bigskip

% Insert additional author notes using the symbols described below. Insert symbol callouts after author names as necessary.
% 
% Remove or comment out the author notes below if they aren't used.
%
% Primary Equal Contribution Note
\Yinyang These authors contributed equally to this work.

% Additional Equal Contribution Note
% Also use this double-dagger symbol for special authorship notes, such as senior authorship.
% \ddag These authors also contributed equally to this work.

% Current address notes
% \textcurrency Current Address: Dept/Program/Center, Institution Name, City, State, Country % change symbol to "\textcurrency a" if more than one current address note
% \textcurrency b Insert second current address 
% \textcurrency c Insert third current address

% Deceased author note
% \dag Deceased

% Group/Consortium Author Note
% \textpilcrow Membership list can be found in the Acknowledgments section.

% Use the asterisk to denote corresponding authorship and provide email address in note below.
* carlospgmat03@gmail.com

\end{flushleft}
% Please keep the abstract below 300 words
\section*{Abstract}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur eget porta erat. Morbi consectetur est vel gravida pretium. Suspendisse ut dui eu ante cursus gravida non sed sem. Nullam sapien tellus, commodo id velit id, eleifend volutpat quam. Phasellus mauris velit, dapibus finibus elementum vel, pulvinar non tellus. Nunc pellentesque pretium diam, quis maximus dolor faucibus id. Nunc convallis sodales ante, ut ullamcorper est egestas vitae. Nam sit amet enim ultrices, ultrices elit pulvinar, volutpat risus.


% Please keep the Author Summary between 150 and 200 words
% Use first person. PLOS ONE authors please skip this step. 
% Author Summary not valid for PLOS ONE submissions.   
%\section*{Author summary}
%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur eget porta erat. Morbi consectetur est vel gravida pretium. Suspendisse ut dui eu ante cursus gravida non sed sem. Nullam sapien tellus, commodo id velit id, eleifend volutpat quam. Phasellus mauris velit, dapibus finibus elementum vel, pulvinar non tellus. Nunc pellentesque pretium diam, quis maximus dolor faucibus id. Nunc convallis sodales ante, ut ullamcorper est egestas vitae. Nam sit amet enim ultrices, ultrices elit pulvinar, volutpat risus.

\linenumbers

% Use "Eq" instead of "Equation" for equation citations.
% }}}
\section{Introduction} % {{{
\tbnote{Poner intro luego}


% }}}
\section{Pauli channels and dynamical maps}  \label{sec: Pauli Channels} % {{{
% Intro  {{{
% \textbf{Lista de puntos:}
% \begin{itemize}
% \item \textbf{Circuit for a Pauli channel:}  Propose a circuit to simulate a Pauli channel on $n$ qubits. It works by creating a $2n$-qubit state on ancilla qubits.
% \item \textbf{Simulation:} Show the fidelities of simulating the circuit on a quantum computer for many one-qubit channels inside the tetrahedron.
% \item \textbf{For Pauli dynamical maps}: See how the circuit generalizes to parametrized channels and notice that many rotations are needed to create the $2n$-ancilla qubit state. \\
% \end{itemize}

In this section  we introduce the concept of quantum channels, focusing on a
specific type called Pauli channels.  Furthermore, we define Pauli dynamical
maps, which are curves of Pauli channels parametrized by a variable.
% }}}
\subsection{Quantum Channels} \label{subsec: Quantum Channels} % {{{


In quantum mechanics, a closed system's state is represented by a vector in a
Hilbert space $\mathcal{H}$.  The state's evolution is unitary and given by
Schrodinger's equation~\cite{Rieffel}.  However, in real-world situations,
quantum systems are usually open, which means that they interact with their
environment~\cite{Breuer}.  For instance, the system's state may become
entangled with the environment, leading to a loss of information about the
system's state over time.

To describe open systems, instead of state vectors, we use matrices $\rho$ that
act on $\mathcal{H}$.  These matrices are called density matrices, and they
include information about the system's interaction with its environment.  For a
density matrix $\rho$ to be physically valid, it must satisfy two conditions:
$\tr(\rho) = 1$ and it must be positive semi-definite, which is denoted as
$\rho \geq 0$~\cite{chuangbook}.


Knowing this, we can now define quantum channels.  Quantum channels are
operators $\mathcal{E}$ that can describe the evolution of open quantum
systems, such that $\rho \rightarrow \mathcal{E}(\rho)$.  Quantum channels are
the most general linear operations that a quantum system can undergo
independently of its past~\cite{zimansbook,cirac}.  These channels are
constructed based on three fundamental properties: linearity, trace
preservation, and complete positivity.

Linearity ensures that a quantum channel $\mathcal{E}$ maps any ensemble of
density matrices into the corresponding ensemble of their evolution.  The trace
preserving property is given by $\tr (\mathcal{E}[\rho]) = \tr (\rho) = 1$ and
guarantees that the quantum channel does not change the condition that
$\tr(\rho) = 1$.  Finally, the channel should also preserve the condition $\rho
\geq 0$, and a map that does this is called a positive map.  However,
positivity of $\mathcal{E}$ is not enough, and we actually require the more
restrictive condition of complete positivity.  Complete positivity means that
$\mathcal{E} \otimes \mathbb{I}_n$ is positive for any positive integer $n$
(where $\mathbb{I}_n$ is the $n\times n$ identity matrix).  This ensures that
even if the principal system is entangled with another system, applying
$\mathcal{E}$ to the principal system while doing nothing to the other one
still results in  a positive semidefinite state for the principal
system~\cite{chuangbook}. 

Given a quantum channel $\mathcal{E}$, the condition of trace preservation is
straightforward to verify but complete positivity is not as simple.  To test
complete positivity of a quantum channel, Jamiołkowski and
Choi~\cite{choi,jamil} developed a simple algorithm that exploits the
isomorphism between a channel $\mathcal{E}$ and the state $\mathcal{D} =
(\mathbb{I} \otimes \mathcal{E}) [|\Omega \rangle \langle  \Omega|]$, where
$|\Omega\rangle = 1/\text{dim}(\mathcal{H}) \sum_{i}^{\text{dim}(\mathcal{H})}
|i \rangle |i \rangle$ is a maximally entangled state between the original
system and an ancilla.  Remarkably, the map $\mathcal{E}$ is completely
positive if and only if $\mathcal{D}$ (also known as the Choi or dynamical
matrix of $\mathcal{E}$) is positive semidefinite.

% }}}
\subsection{Pauli Channels}  \label{subsec: Pauli Channels} % {{{

We have discussed the main features of quantum channels and 
now we turn our attention to a specific 
type of channels for $N$-qubit systems called Pauli channels.
First we will define these channels for single-qubit systems,
whose most general density matrix can be written as~\cite{chuangbook}:
\begin{equation}
\label{eq: Density Matrix}
\rho = \dfrac{1}{2} \sum_{\alpha=0}^{3} r_{\alpha} \sigma_{\alpha},
\end{equation}
with $\sigma_0 = \mathbb{I}$, and $\sigma_{1,2,3}$ the usual Pauli matrices.
The condition $\tr(\rho) = 1$ requires that $r_0 = 1$ while $\rho \geq 0$ 
implies that the remaining $r_{1,2,3}$ form
a vector $\vec{r}= (r_1,r_2,r_3)$ inside a unit sphere known as the Bloch sphere~\cite{Marinescu}.
That is, every possible density matrix for a one-qubit
system is uniquely associated with a point in a unit sphere. 
% \cpnote{explicar un poco mejor. Me parece que para el publico vale 
% la pena ser un poco mas explicito. pero no estoy muy seguro.}

Given a one-qubit system described by $\rho$, 
a Pauli channel is defined as an operation that with probability $k_{\gamma}$
applies the Pauli matrix $\sigma_{\gamma}$ to
the system, for $\gamma = 0,1,2,3$~\cite{geometry}.
Mathematically, the Pauli channel is written in the following way:
\begin{eqnarray}
\label{eq: Pauli channel 1 qbit}
\mathcal{E}(\rho) = \sum_{\gamma=0}^3 k_{\gamma} \sigma_{\gamma} \rho \sigma_{\gamma},
\end{eqnarray} 
where the probabilities $k_{\gamma}$ of applying $\sigma_{\gamma}$
are non-negative real numbers such that 
$\sum_{\gamma} k_{\gamma} = 1$ (these conditions also ensure that the channel is 
trace preserving and completely positive).

Pauli channels are some of the 
most fundamental noise models in quantum information science~\cite{Terhal}. 
Some notable examples of Pauli channels are the following:
\begin{itemize}
\item \textbf{Bit Flip Channel:} This is a channel that with probability $1-p$ leaves the qubit as it is 
and with probability $p$ it applies the $\sigma_1$ matrix 
(which flips the basis states $|0\rangle$ and $|1\rangle$ of the qubit), and
so it is given by:
\begin{align*}
\mathcal{E}(\rho) = (1-p) \rho + p \sigma_1 \rho \sigma_1.
\end{align*}
Analogous channels exist using $\sigma_3$ (called the bit flip channel,
which has a probability $p$ of adding a relative phase $\pi$ to the state) or 
using $\sigma_2$ (called the phase flip channel, 
which has a probability $p$ of 
flipping the base states and also add a relative phase $\pi$).
\item \textbf{Depolarizing channel:} 
This channel has a probability $1-p$
of doing nothing to the qubit and a probability $p$ of converting it into the maximally mixed state $\dfrac{1}{2} \mathbb{I}$
and it can be written as:
\begin{equation}
\mathcal{E}(\rho) = (1-p)\rho + p \dfrac{1}{2} \mathbb{I} = \left(1 - \dfrac{3p}{4} \right) \sigma + \dfrac{p}{4} \sigma_1 \rho \sigma_1 + \dfrac{p}{4} \sigma_2 \rho \sigma_2+ \dfrac{p}{4} \sigma_3 \rho \sigma_3.
\end{equation} 
\end{itemize}

We can also see how an arbitrary Pauli channel acts on an arbitrary  
density matrix.
To do it, we substitute \eref{eq: Density Matrix} 
in \eref{eq: Pauli channel 1 qbit}:
\begin{equation}
\mathcal{E}(\rho) = \dfrac{1}{2}\sum_{\gamma,\alpha=0}^3 k_{\gamma} r_{\alpha} \sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma}.
\end{equation}
This can be simplified by using the following property of Pauli matrices:
\begin{equation}
\label{eq: propiedad-pauli}
\sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma} = A_{\alpha,\gamma} \sigma_{\alpha}, \;\;\;\;\; \text{with} \; A_{\alpha,\gamma} = \begin{pmatrix}
1 & 1 & 1 & 1\\
1 & 1 & -1 &-1 \\
1 & -1 & 1 & -1 \\
1 & -1 & -1 & 1
\end{pmatrix},
\end{equation}
which leads to
\begin{equation}
\label{eq: rho-transformada}
\mathcal{E}(\rho) = \dfrac{1}{2} \sum_{\alpha} \left(\sum_{\gamma} A_{\alpha, \gamma} k_{\gamma} \right) r_{\alpha} \sigma_{\alpha}.
\end{equation}
\eref{eq: rho-transformada} once again has the form of \eref{eq: Density Matrix}
but with components $\left( \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma} \right) r_{\alpha}$.
This gives us another way of understanding Pauli channels
as operations that take each component $r_{\alpha}$
of the density matrix and multiplies them
by $\sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}$, 
that is:
\begin{equation}
\label{eq: multipliers}
r_{\alpha}  \xrightarrow[\text{Channel}]{\text{Pauli}}  \tau_{\alpha} r_{\alpha} ,\;\; \tau_{\alpha} := \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}.
\end{equation}
Notice that $\tau_0 = 1$, which is a consequence of $\sum_{\gamma}k_{\gamma}=1$
and ensures that after the channel, the resulting density matrix still has trace one. 
Furthermore, reverting the definition of $\tau_{\alpha}$ by using that $A^{-1} = \dfrac{1}{4} A$, 
we get that $k_{\gamma} = \dfrac{1}{4} \sum_{\alpha} A_{\alpha,\gamma} \tau_{\alpha}$.
Then, using that $k_{\gamma} \geq 0$
we get the following conditions on the multipliers $\tau_{\alpha}$:
\begin{eqnarray}
\label{eq: conditions-tetrahedron}
&1+\tau_i -\tau_j - \tau_k \geq 0,  \;\;\; \text{for $i,j,k$ different numbers in $\{1,2,3\}$}, \\
&1+\tau_1 + \tau_2 + \tau_3 \geq 0.
\end{eqnarray}

These conditions imply that $(\tau_1,\tau_2,\tau_3)$
has to be inside a tetrahedron with
vertices $(1,1,1), (1,-1,-1),(-1,1,-1)$ and $(-1,-1,1)$. 
Therefore, the $\tau_{1,2,3}$ are numbers between 
$-1$ and $1$, which means that the components
$r_{\alpha}$ of the density matrix are always 
attenuated and possibly sign flipped.

Having defined the one qubit case,  we can now generalize to $N$ qubits.
In order to do it, we need to introduce the so-called \textit{Pauli strings}, defined as
\begin{eqnarray}
\label{eq: Pauli string}
\sigma_{\vec{\alpha}} = \sigma_{\alpha_1} \otimes \sigma_{\alpha_2}\otimes \cdots \otimes \sigma_{\alpha_N},
\end{eqnarray}
where $\vec{\alpha}$ denotes a multi-index $(\alpha_1, \cdots, \alpha_N)$
 and $\alpha_i \in \{0,1,2,3\}$. 
These operators form an orthogonal basis in the space of operators acting on $N$ qubits. 
 Similarly to the single-qubit case, the density matrix $\rho$ 
of a system of $N$ qubits can be written using Pauli strings as:
\begin{equation}
\label{eq:  Density matrix Nqbit}
\rho = \dfrac{1}{2^N} \sum_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}}.
\end{equation}
Then, just as before, we define a Pauli channel as a transformation that applies 
the operator $\sigma_{\vec{\gamma}}$ to $\rho$ with probability $k_{\vec{\gamma}}$
and is therefore described mathematically by:
\begin{equation}
\label{eq: pauli channel N-qubit}
\mathcal{E}(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}} \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{equation}
where just as before, $k_{\vec{\gamma}}$ are non-negative real numbers such 
that $\sum_{\vec{\gamma}} k_{\vec{\gamma}}=1$.

As in the one qubit case, Pauli channels for $N$ qubits 
attenuate the components $r_{\vec{\alpha}}$ of the density matrix.
This can be seen by substituting \eref{eq:  Density matrix Nqbit} in \eref{eq: pauli channel N-qubit}
and using the property of \eref{eq: propiedad-pauli}:
\begin{align*}
\mathcal{E}(\rho) &= \dfrac{1}{2^N} \sum_{\vec{\gamma},\vec{\alpha}} k_{\vec{\gamma}} r_{\vec{\alpha}} \sigma_{\vec{\gamma}} \sigma_{\vec{\alpha}} \sigma_{\vec{\gamma}} \\
& = \dfrac{1}{2^N} \sum_{\vec{\alpha}} \left( \sum_{\vec{\gamma}} (A^{\otimes^N})_{\vec{\alpha},\vec{\gamma}} \; k_{\vec{\gamma}} \right) r_{\vec{\alpha}} \sigma_{\vec{\alpha}},
\end{align*}
which means that applying the Pauli channel multiplies the 
components $r_{\vec{\alpha}}$ by $\tau_{\vec{\alpha}} := \sum_{\vec{\gamma}} (A^{\otimes^N})_{\vec{\alpha},\vec{\gamma}} k_{\vec{\gamma}}$.
% }}}
\subsection{Pauli Dynamical Maps} % {{{
\label{subsec: Pauli Dynamical Maps}


As seen in the last section, Pauli channels and in 
general quantum channels are discrete maps
that transform a density matrix $\rho$ into $\mathcal{E}(\rho)$.
However, we could also define a continuous set of 
channels $\varepsilon_p$ with $p$ a real parameter.

For the special case of Pauli channels, we define 
a Pauli dynamical map as a continuous parametrized 
curve drawn inside the set of Pauli channels and starting at the identity channel. 
Therefore, a Pauli dynamical map can be written as
\begin{eqnarray}
\label{eq: Pauli dynamical map}
\mathcal{E}_p(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}}(p) \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{eqnarray}
where $p$ is a parameter in an interval $[a,b]$ 
and $\mathcal{E}_p$ is a Pauli channel for every $p$, 
with $\mathcal{E}_a$ being the identity channel.

% }}}
% }}}
\section{Circuit for a Pauli Channel} % {{{
\label{sec: Circuit for a Pauli Channel}
% Intro {{{

In this section we propose a quantum circuit that simulates $N$-qubit Pauli
channels.  Moreover, we implement the circuit for $N=1$ on a quantum computer
and analyze the results using the diamond norm.
We find that close to the depolarizing channel, the general circuit simulator 
can implement such channels with the highest fidelity. 
% produce the highest 
% \cpnote{Quizá en una frase poner el resultado aca o ampliar
% tantito} \tbnote{Va, agregué lo siguiente: 
% We conclude that the circuit performs optimally for channels  in proximity to the
% completely depolarizing channel but
% it is deficient close to unitary channels.}
% }}} 
\subsection{Description of the Circuit for a Pauli Channel} %{{{
\label{subsec: Description of the circuit}



% \cpnote{Yo abriría este parrafo con una frase que de la idea muy general. Decir 
% algo asi como que vamos a crear un estado conque contenga a las $k$s 
% como coeficientes y leugo controlar la aplicación de los Pauli strings. Luego
% ya dar los detalles. Así incluso mas escueto de lo que pongo. Por ejemplo:
% To design the circiot that implements 13, we construct a state that incorportes
% probabilities $k$ and subsequently apply controlled operation. In particular... }
% \cpnote{No me gusta como está organizado este parrafo. Le puedes dar una iterada?}
% \tbnote{Propongo el párrafo en naranja para sustituirlo}


% To design the circuit, we recall that a Pauli channel, as the one in
% \eref{eq: pauli channel N-qubit}, applies each Pauli operator
% $\sigma_{\vec{\gamma}}$ on $\rho$ with a probability $k_{\vec{\gamma}}$.
% Given this, it is easy to construct a quantum circuit that implements 
% a Pauli channel with the help of $2N$ ancilla qubits,
% see \fref{fig: circuit-pauli}.
% The general idea is to produce the probabilities $k_{\gamma}$ by creating the state
% \begin{eqnarray}
% \label{eq: state0}
% \sum_{\vec{\gamma}} b_{\vec{\gamma}} |\vec{\gamma} \rangle
% \end{eqnarray}
% in the ancilla qubits, 
% where $b_{\vec{\gamma}}$ are numbers such that $
% |b_{\vec{\gamma}}|^2 = k_{\vec{\gamma}}$.
% The $2N$-qubit state $|\vec{\gamma}\rangle$  is defined as $|\gamma_1 \rangle
% \cdots |\gamma_N\rangle$.

% {\color{orange} Cambiar por:  
To design the circuit that implements \eref{eq: pauli channel N-qubit}, we construct a state that 
includes the probabilities $k_{\gamma}$ on the ancilla qubits and subsequently
apply controlled Pauli operations on the main qubits.  The circuit that does
this is presented in \fref{fig: circuit-pauli}. 


\begin{figure} % {{{
\centering
% \begin{quantikz}
% \lstick{$q:\; |0\rangle^{\otimes N}$} & \qw & \gate{\sigma_{\vec{\gamma} }} \gategroup[wires=2,steps
% =1,style={dashed, inner sep=4pt}]{Repeat for all $\vec{\gamma}$}
% \gategroup[wires=2,steps
% =1,style={dashed, inner sep=4pt}, label style = {label position = below, yshift = 0.15cm}]
% {$|\vec{\gamma}\rangle$} & \qw \\
% \lstick{$\tilde{q}:\; |0\rangle^{\otimes 2N}$} & \gate[wires=1]{\text{Create the $2N$ qubits state $\sum_{\vec{\gamma}} b_{\vec{\gamma}}   |\vec{\gamma} \rangle$}} & \ctrl{-1} 
% % \gategroup[wires=1,steps
% %=1,style={color=white, inner sep=0pt}, label style= {label position=below}]{$|\vec{\gamma}\rangle$} 
% & \qw 
% \end{quantikz}
\includegraphics{images/circuito_general.pdf}
\caption{{\bf Circuit for an $N$-qubit
Pauli channel on $N$ qubits.}
The circuit creates the state $\sum_{\vec{\gamma}} b_{\vec{\gamma}}|\vec{\gamma}\rangle$ 
on the $2N$ ancilla qubits denoted by $\tilde{q}$. }
\label{fig: circuit-pauli}
\end{figure} % }}}

The first part of the circuit involves the creation of the state
\begin{eqnarray}
\label{eq: state}
\sum_{\vec{\gamma}} b_{\vec{\gamma}} |\vec{\gamma} \rangle
\end{eqnarray}
on the ancilla qubits, where $b_{\vec{\gamma}}$ are numbers such that $
|b_{\vec{\gamma}}|^2 = k_{\vec{\gamma}}$ and
the $2N$-qubit state $|\vec{\gamma}\rangle$ is defined as $|\gamma_1\rangle
\cdots |\gamma_N\rangle$.
% \cpnote{La primera frase es cierta, pero no le veo el sentido acá. Trata de reformular el parrafo 
% de nuevo. Croe que el ``This means'' definitivamente no va y es el que le da un sentido ``raro''. 
% Itera (quizá solo quitando esas dos palabras)} \tbnote{Concuerdo, quité eso.}
When measured in the computational basis, the state given in \eref{eq: state}
collapses to $|\vec{\gamma}\rangle$ with a 
probability $|b_{\vec{\gamma}}|^2 = k_{\vec\gamma}$. 
The circuit in \fref{fig: circuit-pauli} uses this fact
to apply $\sigma_{\vec{\gamma}}$ on the main qubits
with a probability $k_{\vec\gamma}$ by using controlled operations 
conditioned on the state of the system being $|\vec{\gamma}\rangle$,
just as the Pauli channel is supposed to do.  
% 
% that apply $\sigma_{\vec{\gamma}}$ to the main qubits
% only if the ancilla qubits are in the state $|\vec{\gamma}\rangle$.
% 
% Therefore, the circuit from \fref{fig: circuit-pauli} 
% applies each operation $\sigma_{\vec{\gamma}}$ to the principal qubits 
% with a probability $k_{\vec{\gamma}}$, 
% just as a Pauli channel is supposed to do.  

\cpnote{Evaluar si al final ponemos algo al respecto de este comentario}
\cpnote{Del circuito, parece ue las fases de las bs gammas no omportan mucho (o nada). 
Esa libertad la hemos considerado? De alguna manera colapsan curvas de las que
hemos visto?} \tbnote{Sí, es una libertad que se tiene y he considerado y significa que hay muchas elecciones de $b_{\gamma}$ para un mismo canal.
Es una de las varias cosas que complicaba determinar uno a uno qué canales se pueden hacer.}


%}}}
\subsection{Simulation for one-qubit Pauli channels} % {{{
\label{subsec: Simulation for one-qubit Pauli channels}

For the particular case of a Pauli channel on one qubit, the circuit that
simulates it can be constructed as in \fref{fig: circuit-pauli-1},
which is a special case of \fref{fig: circuit-pauli}
but with all details  explicitly shown.
In said figure, the state 
$\sqrt{k_{00}} |00\rangle + \sqrt{k_{01}} |01\rangle + \sqrt{k_{10}} 
|10\rangle + \sqrt{k_{11}}|11\rangle$
is created on the ancilla qubits with the help of three rotations of angles:
\begin{subequations}
\begin{eqnarray}
\theta_0 &= &\arg(\sqrt{k_{00}} + i \sqrt{k_{01}}) -
\arg(\sqrt{k_{10}} + i\sqrt{k_{11}})
\label{eq:angle1} \\ 
\theta_1 &= &2 \arccos(\sqrt{k_{00} +
k_{01}})
\label{eq:angle2} \\
\theta_2 &= &\arg(\sqrt{k_{00}} + i \sqrt{k_{01}}) +
\arg(\sqrt{k_{10}} + i\sqrt{k_{11}})
\label{eq:angle3}
\end{eqnarray}
\label{eq:angle}
\end{subequations}
\cpnote{Acá te falto la puntuación en las ecuaciones. Porotro lado me gustaría ver la 
forma que tienen las ecuaciones en exponenciales o en funciones trigonometricas
que quizá estén mas bonitas.}



\begin{figure} % {{{
\centering
\includegraphics{images/circuito_unqubit.pdf}
\caption{
% \cpnote{ No me gusta que esté tan cargado de ecuaciones el caption. Metelas en
% el lugar apropiado en el texto} \tbnote{Lo pasé al texto}
{\bf One qubit Pauli channel circuit.} Circuit for a one-qubit Pauli channel,
which is a particular case of \fref{fig: circuit-pauli}.  Here we have two
ancilla qubits and we use three rotations
of angles given by \eref{eq:angle} to create the state $\sqrt{k_{00}}
|00\rangle + \sqrt{k_{01}} |01\rangle + \sqrt{k_{10}} 
|10\rangle + \sqrt{k_{11}}|11\rangle$
on them.
\cpnote{Creo qeu este seria el estado ecuacion 14, pero como qeuno está limpio. 
Creo quepodemos nombrar ese estado y luego referirnos acá por el nobmre y la referencia 
a la ecuación.}
%and the state $b_{00} |00\rangle + b_{01} |01\rangle + b_{10}
%|10\rangle + b_{11}|11\rangle$ is created on them with the help of three
%rotations of angles $\theta_0 = \arg(\sqrt{k_{00}} + i \sqrt{k_{01}}) -
%\arg(\sqrt{k_{10}} + i\sqrt{k_{11}})$, $ \theta_1 = 2 \arccos(\sqrt{k_{00} +
%k_{01}})$ and $ \theta_2 = \arg(\sqrt{k_{00}} + i \sqrt{k_{01}}) +
%\arg(\sqrt{k_{10}} + i\sqrt{k_{11}})$.
}
\label{fig: circuit-pauli-1} 
\end{figure} % }}}


Using the quantum computers that IBM has available~\cite{Qiskit}, we sampled
one-qubit Pauli channels and simulated them using the ibmq-lima quantum
computer\cpnote{la computadora no la usamos para samplear sino solo para simular. Modificar
la frase.}.  For each of these channels, we used quantum process
tomography~\cite{Qiskit, Chuang:1996} to obtain the 
operator $\xi_I$ corresponding to the implementation of the
circuit.  Then, we compared this operator with the ideal 
channel $\xi_T$  we
wanted to implement.  


\cpnote{Toca rediseñar este parrafo mejor. La figura que al final nos interesa es 
la $f$, pero no se menciona acá. Toca como que hacer que el párrafo gire alrededor de ella. }
We shall use the diamond norm~\cite{Aharonov,Wilde}, which has a simple physical meaning related
with the probability that one can distinguish two channels.
% To perform this comparison, we used the diamond norm~\cite{Aharonov,Wilde},
% which gives us a method of discriminating \cpnote{no solo discrimina... todas
% las normas lo hacen, pero nos permite ver que tan parecidos son dos canales. 
% Es como la fidelidad. Itera.} between quantum channels \cpnote{Tambien esta frase
% no conecta bien con lo que sigue}.
In particular, suppose an agent is given one of the channels $\xi_I$, $\xi_T$
with probability $1/2$ each,
and tries to guess which channel they received
by applying it to a state $\rho$ and measuring the result.
Then, the maximal probability of success (out of all possible states $\rho$) that
the agent guesses correctly is~\cite{Benenti}:
\begin{equation}
\label{eq: probability-success}
p_{\succ} = \dfrac{1}{2}+ \dfrac{1}{4} ||\xi_I - \xi_T ||_{\diamond},
\end{equation}
where $|| \cdot ||_{\diamond}$ is the diamond norm, defined by 
\begin{align*}
||\xi_I - \xi_T ||_{\diamond}  = \max_{\rho} || (\xi_I \otimes I) \rho - (\xi_T \otimes I) \rho ||_1,
\end{align*}
with $I$ the identity map,
$|| \cdot ||_1$ the trace norm and the maximization
done over all density matrices $\rho$.
\cpnote{Esa definicion esta bonita y me gusta, pero supongo qeu no es asi somo la 
calculas. }
   
Notice that if the channels are the same, then $p_{\succ}=1/2$. 
This is expected because in this situation the agent
has no way of distinguishing the channels and has no choice but to completely
guess, which results in a probability of success of $1/2$.
On the other hand, $p_{\succ}=1$ indicates that the channels are perfectly
distinguishable.
\cpnote{Creo qeu el ejemplo debería ir con la $f$ que definamos, quizá pasando por la 
norma diamante, o por la p succ. Eso si, si no la ocupamos (la psucc) tonces quitarla.}
% \cpnote{hummm ejemplo al menos para nosotros.} 
% \tbnote{Un ejemplo que comprobé es considerar el canal que aplica $\sigma_x$ y 
% el que aplica $\sigma_z$ y tienen $p_{\succ}=1$.
% De hecho, al tomar dos canales que consistan en aplicar $\sigma_i$ y $\sigma_j$ 
% (para $i\neq j$), se cumple esto.
% También quería ejemplos no unitarios, pero no encontré.}

Finally, using the representation of Pauli channels in a tetrahedron as
in \eref{eq: conditions-tetrahedron},
we show in \fref{fig: fidelity one qubit} the maximal probabilities of
success defined by \eref{eq: probability-success} for the channels
analyzed. 
We can see that channels close to the 
completely depolarizing
channel (that is close to the center of the tetrahedron)
have a low $p_{\succ}$, while those 
close to unitary channels have much higher $p_{\succ}$.
This means that channels closer to the 
completely depolarizing channel are simulated better on the quantum computers.
This is reasonable because quantum computers are prone to errors
that depolarize qubits, which isn't very problematic
when trying to simulate depolarization but it is 
when simulating unitary processes.
\cpnote{Siento qeu aun falta algo de análisis pero lo dejamos para cuando tengamos mas
figuras y mas inspiracion}
\tbnote{Va}

\begin{figure}
\centering
\begin{subfigure}{0.9\textwidth}
\begin{subfigure}{.666\textwidth}
\centering
\includegraphics[width=.95\columnwidth]{images/tetra-def.png}
\end{subfigure}%
\begin{subfigure}{.333\textwidth}
\includegraphics[width=.95\columnwidth]{images/corte1-2.png} \\
\includegraphics[width=.95\columnwidth]{images/corte2-2.png} \\
\end{subfigure}
\includegraphics[width=.322\columnwidth]{images/corte3-2.png}
\includegraphics[width=.322\columnwidth]{images/corte4-2.png}
\includegraphics[width=.322\columnwidth]{images/corte5-2.png}
\end{subfigure}%
\begin{subfigure}{0.1\textwidth}
\includegraphics[width=.8\columnwidth]{images/col-2.png} \\ [2ex]
\end{subfigure}
\caption{\cpnote{porfa escribe el caption.} \tbnote{Aquí está una forma
alternativa en que puede quedar la figura.  Usé $2(1-p_{succ})$ en lugar de
$p_{succ}$ para que se cumpla lo de que $0$ es lo peor y $1$ lo mejor.}}
\end{figure}







% }}}
% }}}
\section{One Parameter Circuits} % {{{
\label{sec: 1PR Circuits}


Just as Pauli channels, Pauli dynamical maps can be implemented using the circuit
of \fref{fig: circuit-pauli}. However, there is one difference: 
the state to be created on the ancilla qubits now 
depends on a parameter $p$, and it is represented by the expression:
\begin{eqnarray}
\label{eq: parametrized state}
\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle.
\end{eqnarray}
Thus, we temporarily shift our focus from Pauli
channels and dynamical maps to the general problem of 
creating a circuit to generate a curve of
states like the one described in \eref{eq: parametrized state}.

In general, producing this curve of states for $N$ qubits will require
$2^N-1$ rotations parametrized by $p$\cpnote{De de donde sale este numero?},
such as the three rotations used for the ancilla
qubits in \fref{fig: circuit-pauli-1}.
However, it would be preferable to achieve the same effect using only one parametrized rotation. 
This would allow us to interpret said rotation 
as a knob that smoothly traverses the curve of states.
Consequently, we are faced with the question of which curves of states, 
such as the one described in \eref{eq: parametrized state}, 
can be produced using just a single parametrized rotation. 
To clarify this, we provide the following definition 
for a circuit with one parametrized rotation.

\begin{definition}{\textbf{1-Parameter Rotation Circuit:}}
A 1-Parameter Rotation (1PR) circuit is a parametrized quantum
circuit that includes only one gate dependent on a parameter $p$.
Moreover, the parametrized gate is a one-qubit rotation about any axis,
whether controlled or not.
\end{definition}

Based on this definition, we aim to determine which curves of 
states can be generated using 1PR circuits. 
To accomplish this, we begin by proving that all 1PR circuits have 
the form depicted in \fref{fig:1PR-circuit},
where the parametrized rotation is around $\sigma_3$ and
is applied to the last qubit.

\begin{figure} % {{{
\centering
\includegraphics{images/OPR-circuit.pdf}
\caption{\textbf{General form of a 1PR circuit}.
Any 1PR circuit can be transformed into this form,
where the rotation on the last qubit
can be controlled or not by any of the other qubits.
$A$ and $B$
are $N$-qubit gates that do not depend on the parameter $p$ and
$s= s(p)$ is a function of the parameter.
}
\label{fig:1PR-circuit}
\end{figure} % }}}

\begin{theorem}
An $N-$qubit 1PR circuit can always be transformed 
into the form shown in \fref{fig:1PR-circuit}.
\end{theorem}
\textbf{Proof:} 
First, we observe that according to the
definition, a 1PR circuit always consists of an operation $B$ followed 
by the parametrized rotation and then another operation $A$, 
where $A$ and $B$ are not parametrized.

Next, we note that it is not necessary to consider rotations about an arbitrary axis,
as a rotation about any axis $\hat{n}$ parameterized by $p$
can be transformed into a rotation about $\sigma_3$ without introducing 
gates that depend on $p$. To see this, consider the rotation $R_{\hat{n}}(2s)$, where $2s$ 
is a function of $p$ (the factor of 2 is for convenience later on) 
and $\hat{n} = (n_1,n_2,n_3)$ represents the rotation axis. 
We can express $\hat{n}$ as $(\sin \theta \cos \phi, \sin \theta \sin \phi, \cos \theta)$, 
where $\theta$ and $\phi$ are fixed angles dependent on $\hat{n}$. 
The rotation can then be rewritten as follows:
\begin{eqnarray}
R_{\hat{n}}(2s) = R_{\sigma_3}(\phi) R_{\sigma_2}(\theta) R_{\sigma_3}(2s) R_{\sigma_2}(-\theta) R_{\sigma_3}(-\phi).
\end{eqnarray}
Since the angles $\theta$ and $\phi$ do not depend on the parameter $p$,
any 1PR circuit can be transformed into a circuit where the parametrized
 rotation is around $\sigma_3$ instead of an arbitrary axis. 
Moreover, without loss of generality, we can choose the last qubit as the
target qubit for the rotation, since if it weren't, we could use
swap gates to move the rotation
to the first qubit without adding gates
that depend on $p$. 

Therefore, a 1PR circuit can be transformed such
that the rotation is around $\sigma_3$ and is applied to the last qubit 
(possibly controlled by other qubits), 
resulting in the form depicted in \fref{fig:1PR-circuit}. 
$\blacksquare$ \\
$\;$\\

With the aid of this theorem, we can now determine the curves
of states of $N$ qubits that can be generated using a 1PR circuit. 
This result is stated in the following theorem.

\begin{theorem}
Consider a 1PR circuit of $N$ qubits
and denote by $U$ the operator it implements on this system. 
Then, for every $j \in \{0, 1, \cdots, 2^N-1\}$, 
we have that:
\begin{align*}
U|j\rangle = e^{is} |a^j\rangle + e^{-is} |b^j\rangle + |c^j\rangle
\end{align*}
with $|a^j\rangle ,|b^j\rangle, |c^j\rangle$ orthogonal states and $|a^j|^2 + |b^j|^2 + |c^j|^2 = 1$.
\end{theorem}
\textbf{Proof:} 
\cpnote{Discutir la prueba, se ve demasiado larga y aburrida}
\tbnote{La cambié un poco, pero no sé qué más cambiarle.}
We can conclude from theorem 1 that $U=ARB$,
where $A$ and $B$ are unitary matrices and $R$ is a $\sigma_3$ rotation of angle $2s$
applied to the last qubit and controlled by some of the other ones. 

First, applying $B$ to $|j\rangle$ results in $B|j\rangle = B_{0,j} |0\rangle + B_{1,j} |1 \rangle + \cdots + B_{2^n-1,j}|2^n-1\rangle$,
with $B_{i,j}$ the entries of matrix $B$.
This can be rewritten by separating last qubit from the other $N-1$:
\begin{equation}
B|j\rangle = \sum_{k=0}^{2^{N-1}-1} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right).
\end{equation}
After the operator $B$, the circuit applies the  controlled rotation $R$.
To simplify the analysis, we separate the states of
the first $N-1$ qubits into those that fulfill the control conditions of the rotation
(which we denote as the set $\mathcal{C}$)
and those that do not, and write it as
\begin{align}
B|j\rangle = \sum_{k \in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right) + \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right),
\end{align}
Then, the rotation $R$ will only affect the states on the first sum (since they fulfill the control conditions)
and not the others. Therefore,  
remembering that a $\sigma_3$ rotation acts by adding a phase $e^{-is}$ to $|0\rangle$
and a phase $e^{is}$ to $|1\rangle$, we have that,
% \begin{small}
% \begin{eqnarray}
% &e^{-is} \sum_{k \in \mathcal{C}} B_{2k,j} |k\rangle |0\rangle + e^{is} \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |1 \rangle 
% + \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle |0\rangle + B_{2k+1} |k\rangle |j \rangle \right)\\
% & \qquad = e^{-is} \vec{b'}_j + e^{is} \vec{a'}_j + \vec{c'}_j,
% \end{eqnarray}
% \end{small}
% test
\begin{align}
RB|j\rangle& = e^{-is} \sum_{k \in \mathcal{C}} B_{2k,j} |k\rangle |0\rangle + e^{is} \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |1\rangle 
+ \sum_{k \not\in \mathcal{C}} \left( B_{2k,j} |k\rangle|0\rangle  + B_{2k+1,j} |k \rangle |1\rangle  \right) \nonumber \\
& = e^{-is} |\mathfrak{b}^{j}\rangle + e^{is} |\mathfrak{a}^j\rangle + |\mathfrak{c}^j\rangle
\end{align}
where we defined $|\mathfrak{a}^j \rangle = \sum_{k \in \mathcal{C}} B_{2k,j}|k\rangle|0\rangle$,
$|\mathfrak{b}^j\rangle = \sum_{k \in \mathcal{C}} B_{2k+1,j} |k\rangle |0 \rangle$,
$|\mathfrak{c}^j\rangle =\sum_{k \not\in \mathcal{C}}\big( B_{2k,j} |k\rangle|0\rangle+$ $B_{2k+1,j} |k \rangle |1\rangle  \big)$.
\cpnote{Preferira que tuvieramos que los kets fisicos tuvieran la notacion de
ket. Intenta modificarlo asi y luego sigo con la prueba. Ya no me está pareciendo 
tan latosa. Trata tambien que los nombres que usas sean como consistentes o tengan 
algo que decir de su contenido.} \tbnote{Ya hice unos cambios}
These states are clearly orthogonal because they are each linear combinations of different 
orthogonal states of the computational basis. 
Moreover, they satisfy  $|\mathfrak{a}^j|^2 + |\mathfrak{b}^j|^2 + |\mathfrak{c}^j|^2 = 1$ because this quantity is the squared norm of the $j$th column of $B$, 
which is unitary.

Finally, after having applied the rotation, the circuit applies gate $A$, 
so that the result is given by:
\begin{eqnarray}
U|j\rangle = ARB|j\rangle = e^{-is} A |\mathfrak{a}^j\rangle + e^{is} A |\mathfrak{b}^j\rangle + A |\mathfrak{c}^j\rangle = e^{-is} |a^j\rangle + e^{is} |b^j\rangle + |c^j\rangle,
\end{eqnarray}
where $|a^j\rangle = A |\mathfrak{a}^j\rangle, |b^j\rangle = A |\mathfrak{b}^j\rangle, |c^j\rangle = A |\mathfrak{c}^j\rangle$ are still orthogonal
states that satisfy $|a|^2 + |b|^2 + |c|^2 = 1$ because $A$ is unitary. $\blacksquare$  \\
 $\;$ \\
 
This theorem implies that starting from the state $|0\rangle$ (or any 
other starting state),
the only curves of states we could expect to create
with a 1PR circuit are those of the form $U|0\rangle$, that is, curves such as:
\begin{equation}
|\eta(p)\rangle = |c\rangle + e^{is}|a\rangle + e^{-is} |b\rangle,
\label{eq:curve-states}
\end{equation}
with 
\begin{equation}
|a|^2 + |b|^2 + |c|^2 = 1  \; \text{and} \; |a\rangle, |b\rangle, |c\rangle \; \text{orthogonal states},
\label{eq:conditions-vecs}
\end{equation}
and $s = s(p)$ a function of $p$.
Furthermore, given a curve of states as the one in
\eref{eq:curve-states}, we can always construct a 1PR circuit to create it.
One way of doing it, is to use the circuit of \fref{fig:1PR-circuit}, setting the parametrized
rotation $R$ on the last qubit to be controlled by all the other qubits
and defining the operators $A$ and $B$ by:
\begin{align*}
&B|0\rangle = |a| |2^{N}-1 \rangle + |b| |2^{N}-2\rangle + |c| |2^N-3\rangle, \\
&A|2^N-1 \rangle = \frac{1}{|a|} |a\rangle,\; A|2^{N}-2\rangle = \frac{1}{|b|}|b\rangle, \; A|2^{N}-3\rangle = \frac{1}{|c|}|c\rangle.
\end{align*}
The rest of the operators $A$ and $B$ can be
defined arbitrarily in any way such that they are unitary.
Then, starting from the initial state $|0\rangle$
and applying the circuit  of \fref{fig:1PR-circuit}, 
some direct calculations lead us  to 
the resulting curve of states
of \eref{eq:curve-states}.
To see it, notice that rewriting the expression of  $B|0\rangle$ by separating the
first $N-1$ qubits from the last one,
we have that $$B|0\rangle = |a| |2^{N-1}-1\rangle |1\rangle + |b| |2^{N-1}-1\rangle |0\rangle + |c| |2^{N-1}-2\rangle |1\rangle.$$
Then, since the parametrized rotation $R$ is controlled by all the first $N-1$ qubits, it only applies
to the first two terms of $B|0\rangle$ 
and gives as a result
$$
RB|0\rangle =|a| e^{is} |2^{N-1}-1\rangle |1\rangle + |b| e^{-is} |2^{N-1}-1\rangle |0\rangle + |c| |2^{N-1}-2\rangle |1\rangle.
$$
Finally, applying $A$ as defined above to this state leads to the desired result.
 
%Therefore, from this theorem we conclude that
%the kind of curves of states that can be created
%using a 1PR circuit are always of the form
%\begin{align*}
%|b(p)\rangle= e^{is} \vec{a} + e^{-is} \vec{b} + \vec{c},
%\end{align*}
%where $s$ is a function of $p$, $\vec{a},\vec{b},\vec{c}$ are orthogonal vectors and
%$|\vec{a}|^2+  |\vec{b}|^2 + |\vec{c}|^2 = 1$.
%%\textbf{Puntos:}
%\begin{itemize}
%\item As said before, to implement a Pauli dynamical map, 
%we need to create the parametrized $2n$-qubit state 
%$\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle$ on the ancilla qubits.
%\item However, creating this state will in general require many rotations parametrized by $p$. 
%For example, for the case of a Pauli dynamical map on 1 qubit, 
%the parametrized state of the $2$ ancilla qubits in general requires $3$ parametrized rotations and can be constructed as follows: (poner circuito).\\
%In general, to create a parametrized state on $2n$ ancilla qubits will require
%$2n-1$ rotations parametrized by $p$.
%\item How can we reduce the amount of parametrized rotations used?
%\item \textbf{1PR Circuit:} Define an 1PR circuit (a circuit with one parametrized rotation)
%\item \textbf{Theorem about 1PR circuits:} \textit{An 1PR circuit on $n$ qubits with parameter $p$ always has an operator of the form:}
%\begin{eqnarray}
%U = (\vec{v}_0| \vec{v}_1| \cdots| \vec{v}_{2^n-1})
%\end{eqnarray}
%\textit{where $s = s(p)$ and the column vectors are $\vec{v}_j = e^{is} \vec{a}_j + e^{-is} \vec{b}_j + \vec{c}_j$, with $\vec{a}_j, \vec{b}_j, \vec{c}_j$ orthogonal vectors and $|\vec{a}_j|^2 + |\vec{b}_j|^2 + |\vec{c}_j|^2 = 1$.}
%\item \textbf{Proof:} La prueba está dentro de las ``Cosas-Escritas-Antes'', 
%aunque se puede y debe achicar bastante.
%\end{itemize}
% }}}
\section{1PR circuit for a Pauli map} % {{{
\label{sec: 1PR circuit for a Pauli map}


We can now use the previous results to conclude directly which Pauli dynamical maps
can be implemented with a 1PR circuit.
Given this condition, the curve of states of \eref{eq: parametrized state}  needed 
to implement the map
has to be constructed with only one parametrized rotation. 
Therefore, the results of the last section imply that the the map
\begin{eqnarray}
\varepsilon_p(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}}(p) \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{eqnarray}
can be implemented  if there are numbers $\beta_{\vec{\gamma}}(p)$ such that $|\beta_{\vec{\gamma}}(p)|^2 = k_{\vec{\gamma}}(p)$ and
\begin{eqnarray}
\label{eq:vec}
\sum_{\vec{\gamma}} \beta_{\vec{\gamma}}(p) |\vec{\gamma}\rangle = |c\rangle +  e^{is} |a\rangle + e^{-is}|b\rangle,
\end{eqnarray}
where $|a\rangle,|b\rangle,|c\rangle$ are orthogonal states in  
and $|a|^2+  |b|^2 + |c|^2= 1$.

For the particular case of one qubit,
we can show some examples of Pauli dynamical maps
implementable with a 1PR circuit, which are plotted
in \fref{fig:curves}.


\begin{figure} % {{{
\centering
\includegraphics{images/curvas.png}
\caption{{\bf Some Pauli dynamical maps that can be implemented with a 1PR circuit.}
The curves painted in the tetrahedron
represent Pauli dynamical maps that can be implemented with 1PR circuits.
In particular, the depolarizing (purple), bit flip (blue),
phase flip (green), bit-phase flip (red)
and parabolic (orange). }
\label{fig:curves}
\end{figure} % }}}


\begin{itemize}
\item \textbf{Bit flip map:} 
This dynamical map is defined as
\begin{align*}
\varepsilon_p(\rho) = (1-p)\rho + p\sigma_1 \rho \sigma_1,
\end{align*}
for $p \in [0,1]$. 
Therefore, the curve of states $|\beta(p)\rangle$ needed on the ancilla
qubits is such that 
$|\beta_0(p)|^2= (1-p)^2$, $|\beta_1(p)|^2 = p$, $|\beta_2(p)|^2 = |\beta_3(p)|^2 = 0$.
In particular, if we take the $\beta_j$ to be real,
we need to create the curve of states:
\begin{align*}
|\beta(p)\rangle = \sqrt{1-p} |0\rangle +\sqrt{p} |1\rangle.
\end{align*}
This can be rewritten as
\begin{align*}
|\beta(p) \rangle = e^{is}  \left(\frac{1}{2} |0\rangle - \dfrac{i}{2} |1\rangle \right) + e^{-is} \left( \frac{1}{2} |0\rangle + \frac{i}{2} |1\rangle \right),
\end{align*}
with $s= \arcsin(\sqrt{p})$.
Therefore, we can see that the curve satisfies the conditions of  \eref{eq:conditions-vecs} 
and it can be created with a 1PR circuit.
The exact same thing can be done
for the phase flip and bit phase flip dynamical maps by
changing $\sigma_1$ to
$\sigma_3$ and $\sigma_2$ respectively.

\item \textbf{Depolarizing:} This dynamical map is given by
\begin{align*}
\varepsilon_p(\rho) = (1-3p/4) \rho + (p/4) \sigma_1 \rho \sigma_1 + (p/4) \sigma_2 \rho \sigma_2 + (p/4) \sigma_3 \rho \sigma_3,
\end{align*}
with $p \in [0,1]$. 
Then, taking the $\beta_j$ to be real,
the curve of states needed to create on the ancilla qubits is
\begin{align*}
|\beta(p) \rangle = \sqrt{1-3p/4} |0\rangle + \sqrt{p/4} |1\rangle + \sqrt{p/4} |2 \rangle  + \sqrt{p/4} |3\rangle.
\end{align*}
This state can be rewritten as:
\begin{align*}
|\beta(p)\rangle =& \; e^{is} \left( \dfrac{1}{2} |0\rangle - \dfrac{i}{2\sqrt{3}} |1\rangle - \dfrac{i}{2\sqrt{3}} |2 \rangle - \dfrac{i}{2\sqrt{3}} |3\rangle \right) \\
& + e^{-is} \left( \dfrac{1}{2} |0\rangle + \dfrac{i}{2\sqrt{3}} |1\rangle + \dfrac{i}{2\sqrt{3}} |2\rangle + \dfrac{i}{2\sqrt{3}} |3 \rangle \right),
\end{align*}
with $s = \arcsin(\sqrt{3p/4})$.
We can see that this curve satisfies the conditions of \eref{eq:conditions-vecs}, meaning that it can be created with a 
1PR circuit.

\item \textbf{Parabolic dynamical map:} Finally, we define the parabolic dynamical map as:
\begin{eqnarray}
\epsilon(\rho) = \dfrac{1}{4} (1-p)^2  \rho + \dfrac{1}{4} (1-p^2) \sigma_1 \rho \sigma_1 + \dfrac{1}{4} (1-p^2) \sigma_2 \rho \sigma_2 + \dfrac{1}{4} (1+p)^2 \sigma_3 \rho \sigma_3 ,
\end{eqnarray}
with $p \in [-1,1]$. 
If we take the $\beta_j$ to be real,
we need to create the curve of states:
\begin{eqnarray}
|\beta(p)\rangle = \dfrac{1}{2} (1-p) |0\rangle + \dfrac{1}{2} \sqrt{1-p^2} |1\rangle +  \dfrac{1}{2} \sqrt{1-p^2} |2\rangle +  \dfrac{1}{2}(1+p) |3\rangle.
\end{eqnarray}
This can be rewritten as
\begin{align*}
|\beta(p)\rangle =&\; \left( \dfrac{1}{2}|0\rangle + \dfrac{1}{2} |3\rangle \right) + e^{is} \left( \dfrac{i}{4}|0\rangle + \dfrac{1}{4} |1\rangle + \dfrac{1}{4} |2\rangle - \dfrac{i}{4} |3\rangle \right) \\
& + e^{-is}  \left( \dfrac{-i}{4} |0\rangle + \dfrac{1}{4} |1\rangle + \dfrac{1}{4} |2\rangle + \dfrac{i}{4} |3\rangle \right),
\end{align*}
with $s = \arcsin(p)$, so that
this map fulfills the conditions of  \eref{eq:conditions-vecs}.
\end{itemize}

Furthermore, we can construct other examples of 
Pauli dynamical maps such that they
can be implemented with a 1PR circuit.
To do it, we only need to choose the three states $|a\rangle, |b\rangle, |c\rangle$
that satisfy the conditions of  \eref{eq:conditions-vecs}.
For example, this can be done systematically for the case of curves of states of two qubits
(that is, for Pauli dynamical maps of one qubit)
with the following procedure:
\begin{itemize}
\item[1.] We first choose the norms $|a|, |b|, |c|$
such that $|a|^2 + |b|^2 + |c|^2 = 1$. 
This can be done by selecting two angles
$\mu \in [0, \pi/2] , \nu \in [0,\pi/2]$ and defining:
\begin{align*}
|a| = \sin \nu \cos \mu, \; |b| = \sin \nu \sin \mu , \; |c| = \cos \nu.
\end{align*}
\item[2.] We define $|a'\rangle = |a| |0\rangle$, $|b'\rangle = |b| |1\rangle,$ $|c'\rangle = |c| |2\rangle$.
\item[3.] Finally, we choose a unitary matrix $V$
and use it to define the states $|a\rangle = V |a'\rangle, |b\rangle = V |b'\rangle, |c\rangle = V |c'\rangle$.
This way, since the primed states are orthogonal and their squared norms add up to one,
so do the unprimed states and therefore 
fulfill the conditions of  \eref{eq:conditions-vecs}. 
\end{itemize}

Following this procedure for random
angles and unitary matrices $V$, 
we plot four Pauli dynamical maps 
that can be implemented with a 1PR circuit in \fref{fig:curves-random}.
These maps where constructed with the additional condition
of the map passing through the identity channel.
To do that, we ensure that the vectors also satisfy
$|a\rangle + |b\rangle + |c\rangle = e^{i \theta}|0\rangle$ with $\theta$ an arbitrary
real number.
This way, when $s = 0$ in \eref{eq:vec}, the constructed state
is $e^{i \theta}|0\rangle$, which
corresponds with the identity channel.

To fulfill this additional condition,  we restrict the first row of
$V$ writen as a matrix in 
the computational basis to be $e^{i\theta} (|\vec{a}|, |\vec{b}|, |\vec{c}|,0)$. 
That way, 
\begin{align*}
|a\rangle + |b\rangle + |c\rangle = V (|a'\rangle + |b'\rangle + |c'\rangle ) = V(|\vec{a}|, |\vec{b}|, |\vec{c}|,0)^T = (e^{i\theta},0,0,0)^T.
\end{align*}
The last step is because the first entry of $V(|\vec{a}|, |\vec{b}|, |\vec{c}|,0)^T$
is obtained by calculating the dot product of the first row of $V$ with $(|\vec{a}|, |\vec{b}|, |\vec{c}|,0)^T$, which gives
$e^{i\theta}$. 
Furthermore, the other entries have to be $0$,
since otherwise the norm of the result would be greater than
$1$ but $V$ is unitary and therefore preserves the norm.

\begin{figure} % {{{
\centering
\includegraphics{images/curvas-azar.png}
\caption{{\bf Random Pauli dynamical maps that can be implemented with a 1PR circuit.}
The curves painted in the tetrahedron
represent Pauli dynamical maps that can be implemented with 1PR circuits
that were selected at random using the procedure detailed before.}
\label{fig:curves-random}
\end{figure} % }}}


%\textbf{Puntos:}
%\begin{itemize}
%\item Use the last theorem to conclude directly which maps can be created using an 1PR circuit.
%\item \textbf{Examples:} Show examples that satisfy these conditions: Bit-Flip, parabolic maps, etc. 
%and an example that doesn't satisfy the conditions (ejemplo está en la tesis).
%\end{itemize}
% }}}

\section{Conclusion} % {{{

CO\textsubscript{2} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque. Quisque augue sem, tincidunt sit amet feugiat eget, ullamcorper sed velit. 

Sed non aliquet felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris commodo justo ac dui pretium imperdiet. Sed suscipit iaculis mi at feugiat. Ut neque ipsum, luctus id lacus ut, laoreet scelerisque urna. Phasellus venenatis, tortor nec vestibulum mattis, massa tortor interdum felis, nec pellentesque metus tortor nec nisl. Ut ornare mauris tellus, vel dapibus arcu suscipit sed. Nam condimentum sem eget mollis euismod. Nullam dui urna, gravida venenatis dui et, tincidunt sodales ex. Nunc est dui, sodales sed mauris nec, auctor sagittis leo. Aliquam tincidunt, ex in facilisis elementum, libero lectus luctus est, non vulputate nisl augue at dolor. For more information, see \nameref{S1_Appendix}.
% }}}
\section{Supporting information} % {{{

% Include only the SI item label in the paragraph heading. Use the \nameref{label} command to cite SI items in the text.
\paragraph*{S1 Fig.}
\label{S1_Fig}
{\bf Bold the title sentence.} Add descriptive text after the title of the item (optional).

\paragraph*{S2 Fig.}
\label{S2_Fig}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 File.}
\label{S1_File}
{\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Video.}
\label{S1_Video}
{\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Appendix.}
\label{S1_Appendix}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Table.}
\label{S1_Table}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% }}}
\section{Acknowledgments} % {{{
Support by projects CONACyT 285754, 254515 and UNAM-PAPIIT IG100518, IG101421 is
acknowledged. 


\nolinenumbers

% }}}
% Biblbiografia {{{
% Either type in your references using
% \begin{thebibliography}{}
% \bibitem{}
% Text
% \end{thebibliography}
%
% or
%
% Compile your BiBTeX database using our plos2015.bst
% style file and paste the contents of your .bbl file
% here. See http://journals.plos.org/plosone/s/latex for 
% step-by-step instructions.
% 
%\begin{thebibliography}{10}
%
%\bibitem{bib1}
%Conant GC, Wolfe KH.
%\newblock {{T}urning a hobby into a job: how duplicated genes find new
%  functions}.
%\newblock Nat Rev Genet. 2008 Dec;9(12):938--950.

%\bibitem{bib2}
%Ohno S.
%\newblock Evolution by gene duplication.
%\newblock London: George Alien \& Unwin Ltd. Berlin, %Heidelberg and New York:
%  Springer-Verlag.; 1970.

%\bibitem{bib3}
%Magwire MM, Bayer F, Webster CL, Cao C, Jiggins FM.
%\newblock {{S}uccessive increases in the resistance of {D}rosophila to viral
%  infection through a transposon insertion followed by a {D}uplication}.
%\newblock PLoS Genet. 2011 Oct;7(10):e1002337.
%
%\end{thebibliography}
\tbnote{Poner la bibliografía como ellos dicen (copiarla toda aquí en lugar de ponerla en un archivo .bib)}
\textbf{References}
\bibliography{Bibliography}

% }}}
\newpage
\appendix
%\input{Cosas-Escritas-Antes}


\end{document}
