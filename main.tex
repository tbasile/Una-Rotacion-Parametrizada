\documentclass[10pt,letterpaper]{article} % {{{
\usepackage[top=0.85in,left=2.75in,footskip=0.75in]{geometry}
\usepackage{amsmath,amssymb}
% Use adjustwidth environment to exceed column width (see example table in text)
\usepackage{changepage}

% textcomp package and marvosym package for additional characters
\usepackage{textcomp,marvosym}

% cite package, to clean up citations in the main text. Do not remove.
\usepackage{cite}

% Use nameref to cite supporting information files (see Supporting Information section for more info)
\usepackage{nameref,hyperref}

% line numbers
\usepackage[right]{lineno}

% ligatures disabled
\usepackage[nopatch=eqnum]{microtype}
\DisableLigatures[f]{encoding = *, family = * }

% color can be used to apply background shading to table cells only
\usepackage[table]{xcolor}

% array package and thick rules for tables
\usepackage{array}

% create "+" rule type for thick vertical lines
\newcolumntype{+}{!{\vrule width 2pt}}

% create \thickcline for thick horizontal lines of variable length
\newlength\savedwidth
\newcommand\thickcline[1]{%
  \noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
  \cline{#1}%
  \noalign{\vskip\arrayrulewidth}%
  \noalign{\global\arrayrulewidth\savedwidth}%
}

% \thickhline command for thick horizontal lines that span the table
\newcommand\thickhline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
\hline
\noalign{\global\arrayrulewidth\savedwidth}}


% Remove comment for double spacing
%\usepackage{setspace} 
%\doublespacing

% Text layout
\raggedright
\setlength{\parindent}{0.5cm}
\textwidth 5.25in 
\textheight 8.75in

% Bold the 'Figure #' in the caption and separate it from the title/caption with a period
% Captions will be left justified
\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}
\renewcommand{\figurename}{Fig}

% Use the PLoS provided BiBTeX style
\bibliographystyle{plos2015}

% Remove brackets from numbering in List of References
\makeatletter
\renewcommand{\@biblabel}[1]{\quad#1.}
\makeatother



% Header and Footer with logo
\usepackage{lastpage,fancyhdr,graphicx}
\usepackage{epstopdf}



\usepackage[english]{babel}
\usepackage{graphicx,helvet}
\usepackage{color}
\usepackage{url}
\usepackage{amssymb}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage[inline]{showlabels}
\usepackage{bbm,bm}
\usepackage{soul}
\usepackage{amsfonts}
\usepackage{showlabels}

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{quantikz}

\usepackage[draft,inline,nomargin]{fixme} \fxsetup{theme=color}
\FXRegisterAuthor{cp}{acp}{\color{blue}CP}
\FXRegisterAuthor{tb}{ttb}{\color{green}TB}




%\pagestyle{myheadings}
\pagestyle{fancy}
\fancyhf{}
%\setlength{\headheight}{27.023pt}
%\lhead{\includegraphics[width=2.0in]{PLOS-submission.eps}}
\rfoot{\thepage/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrule}{\hrule height 2pt \vspace{2mm}}
\fancyheadoffset[L]{2.25in}
\fancyfootoffset[L]{2.25in}
\lfoot{\today}

%% Include all macros below

\newcommand{\lorem}{{\bf LOREM}}
\newcommand{\ipsum}{{\bf IPSUM}}
\DeclareMathOperator{\tr}{tr}

%% END MACROS SECTION

% }}}
\begin{document}
% Titulo, afiliacion, abstract  {{{
\vspace*{0.2in}

% Title must be 250 characters or less.


\begin{flushleft}
{\Large
\textbf\newline{Title of submission to PLOS journals} % Please use "sentence case" for title and headings (capitalize only the first word in a title (or heading), the first word in a subtitle (or subheading), and any proper nouns).
}
\newline
% Insert author names, affiliations and corresponding author email (do not include titles, positions, or degrees).
\\
Tomás Basile\textsuperscript{1\Yinyang},
Carlos Pineda\textsuperscript{2*\Yinyang},
\\
\bigskip
\textbf{1} Facultad de Ciencias. Universidad Nacional Autónoma de México, Ciudad de México 01000, Mexico
\\
\textbf{2} Instituto de Física, Universidad Nacional Autónoma de México, Ciudad de México 01000, México
\\
\bigskip

% Insert additional author notes using the symbols described below. Insert symbol callouts after author names as necessary.
% 
% Remove or comment out the author notes below if they aren't used.
%
% Primary Equal Contribution Note
\Yinyang These authors contributed equally to this work.

% Additional Equal Contribution Note
% Also use this double-dagger symbol for special authorship notes, such as senior authorship.
% \ddag These authors also contributed equally to this work.

% Current address notes
% \textcurrency Current Address: Dept/Program/Center, Institution Name, City, State, Country % change symbol to "\textcurrency a" if more than one current address note
% \textcurrency b Insert second current address 
% \textcurrency c Insert third current address

% Deceased author note
% \dag Deceased

% Group/Consortium Author Note
% \textpilcrow Membership list can be found in the Acknowledgments section.

% Use the asterisk to denote corresponding authorship and provide email address in note below.
* carlospgmat03@gmail.com

\end{flushleft}
% Please keep the abstract below 300 words
\section*{Abstract}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur eget porta erat. Morbi consectetur est vel gravida pretium. Suspendisse ut dui eu ante cursus gravida non sed sem. Nullam sapien tellus, commodo id velit id, eleifend volutpat quam. Phasellus mauris velit, dapibus finibus elementum vel, pulvinar non tellus. Nunc pellentesque pretium diam, quis maximus dolor faucibus id. Nunc convallis sodales ante, ut ullamcorper est egestas vitae. Nam sit amet enim ultrices, ultrices elit pulvinar, volutpat risus.


% Please keep the Author Summary between 150 and 200 words
% Use first person. PLOS ONE authors please skip this step. 
% Author Summary not valid for PLOS ONE submissions.   
%\section*{Author summary}
%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur eget porta erat. Morbi consectetur est vel gravida pretium. Suspendisse ut dui eu ante cursus gravida non sed sem. Nullam sapien tellus, commodo id velit id, eleifend volutpat quam. Phasellus mauris velit, dapibus finibus elementum vel, pulvinar non tellus. Nunc pellentesque pretium diam, quis maximus dolor faucibus id. Nunc convallis sodales ante, ut ullamcorper est egestas vitae. Nam sit amet enim ultrices, ultrices elit pulvinar, volutpat risus.

\linenumbers

% Use "Eq" instead of "Equation" for equation citations.
% }}}
\section{Introduction} % {{{


% }}}
\section{Quantum Channels}  \label{sec: Pauli Channels} % {{{
\cpnote{Es raro qeu la seccion y una subseccion se llamen igual. Por discutir con Tomas}
\tbnote{Lo cambié}
\cpnote{El texto esta bien, pero creo qeu la distribucino de subsecciones esta chistosna y 
los titulo tambien. Platicar con Tomas a ver a que llegamos. }

% Intro  {{{
\textbf{Lista de puntos:}
\begin{itemize}
\item \textbf{Circuit for a Pauli channel:}  Propose a circuit to simulate a Pauli channel on $n$ qubits. It works by creating a $2n$-qubit state on ancilla qubits.
\item \textbf{Simulation:} Show the fidelities of simulating the circuit on a quantum computer for many one-qubit channels inside the tetrahedron.
\item \textbf{For Pauli dynamical maps}: See how the circuit generalizes to parametrized channels and notice that many rotations are needed to create the $2n$-ancilla qubit state. \\
\end{itemize}

In this section \cpnote{ser coherente con las subsecciones que se tienen nota que no 
hay mencion a los quantum channels. Menos
cuadrado, quizá pasar por chatgpt. hacerlo al final cuanod se tenga el capitulo
por lo menos leido y aprobado en principio de mi parte.} we introduce the
concept of quantum channels, focusing on a specific type called Pauli channels.
Furthermore, we define Pauli dynamical maps, which
are curves of Pauli channels parametrized by a variable.
% }}}
%\subsection*{Quantum Channels} \label{subsec: Quantum Channels} % {{{


% \cpnote{Creo que toca iterar, pensando un poco en nivel licenciatura. ver ejemplos }
% \cpnote{Tambien creo que no es coherente tener una subseccion para esto si 
% lo qeu se quiere decir en la seccion es otra cosa.}

In quantum mechanics, a closed system's state is represented by a vector in a
Hilbert space $\mathcal{H}$.  The state's evolution is unitary and given by
Schrodinger's equation~\cite{Rieffel}.  However, in real-world situations,
quantum systems are usually open, which means that they interact with their
environment~\cite{Breuer}.  For instance, the system's state may become
entangled with the environment, leading to a loss of information about the
system's state over time.

To describe open systems, instead of state vectors,
we use matrices $\rho$ that act on $\mathcal{H}$.
These matrices are called density matrices, and they include information about the system's interaction with its environment. 
For a density matrix $\rho$ to be physically valid, 
it must satisfy two conditions: $\tr(\rho) = 1$ and it must be positive semi-definite,
which is denoted as $\rho \geq 0$~\cite{chuangbook}.


Knowing this, we can now define quantum channels.
Quantum channels are operators $\mathcal{E}$ that
can describe the evolution of open quantum systems, such that $\rho \rightarrow \mathcal{E}(\rho)$.
Quantum channels are the most general linear operations
that a quantum system can undergo independently of its
past~\cite{zimansbook,cirac}.
These channels are constructed based on three fundamental properties: 
linearity, trace preservation, and complete positivity.

Linearity ensures that a quantum channel $\mathcal{E}$ maps any ensemble
of density matrices into the corresponding ensemble of their evolution.
The trace preserving property is given by $\tr (\mathcal{E}[\rho]) = \tr (\rho) =
1$ and guarantees that the quantum channel does not change the condition that $\tr(\rho) = 1$.
Finally, the channel should also preserve
the condition $\rho \geq 0$, and a map that does this is called a positive map.
However, positivity of $\mathcal{E}$ is not enough, 
and we actually require the more restrictive condition of complete positivity.
Complete positivity means that
$\mathcal{E} \otimes \mathbb{I}_n$ is positive for
any positive integer $n$ 
(where $\mathbb{I}_n$ is the $n\times n$ identity matrix).
This ensures that even if the principal system is entangled with another system,
applying $\mathcal{E}$ to the principal system while doing nothing to the
 other one still results in  a positive semidefinite state for the principal system~\cite{chuangbook}. 

Given a quantum channel $\mathcal{E}$, 
the condition of trace preservation is straightforward to verify but complete positivity is not as simple.
To test complete positivity of a quantum channel, 
Jamiołkowski and Choi~\cite{choi,jamil} developed a simple algorithm that exploits the
isomorphism between a channel $\mathcal{E}$ and the state $\mathcal{D} =
(\mathbb{I} \otimes \mathcal{E}) [|\Omega \rangle \langle  \Omega|]$, where
$|\Omega\rangle = 1/\text{dim}(\mathcal{H}) \sum_{i}^{\text{dim}(\mathcal{H})} |i \rangle |i \rangle$ is a maximally entangled state between the original system and
an ancilla.  Remarkably, the map $\mathcal{E}$
is completely positive if and only if $\mathcal{D}$ (also known as the Choi or
dynamical matrix of $\mathcal{E}$) is positive semidefinite.

\cpnote{Le hice un par de cambios pequeños pero la veo bastante bien. }
\tbnote{Perfecto, gracias!}
% }}}
\subsection{Pauli Channels} 
\label{subsec: Pauli Channels} % {{{

We have discussed the main features of quantum channels and 
now we turn our attention to a specific 
type of channels for $N$-qubit systems called Pauli channels.
First we will define these channels for single-qubit systems,
whose most general density matrix can be written as~\cite{chuangbook}:
\begin{equation}
\label{eq: Density Matrix}
\rho = \dfrac{1}{2} \sum_{\alpha=0}^{3} r_{\alpha} \sigma_{\alpha},
\end{equation}
with $\sigma_0 = \mathbb{I}$, and $\sigma_{1,2,3}$ the usual Pauli matrices.
The condition $\tr(\rho) = 1$ requires that $r_0 = 1$ while $\rho \geq 0$ 
implies that the remaining $r_{1,2,3}$ form
a vector $\vec{r}= (r_1,r_2,r_3)$ inside a unit sphere known as the Bloch sphere~\cite{Marinescu}.
That is, every possible density matrix for a one-qubit
system is uniquely associated with a point in a unit sphere. 
% \cpnote{explicar un poco mejor. Me parece que para el publico vale 
% la pena ser un poco mas explicito. pero no estoy muy seguro.}

Given a one-qubit system described by $\rho$, 
a Pauli channel is defined as an operation that with probability $k_{\gamma}$
applies the Pauli matrix $\sigma_{\gamma}$ to
the system, for $\gamma = 0,1,2,3$~\cite{geometry}.
Mathematically, the Pauli channel is written in the following way:
\begin{eqnarray}
\label{eq: Pauli channel 1 qbit}
\mathcal{E}(\rho) = \sum_{\gamma=0}^3 k_{\gamma} \sigma_{\gamma} \rho \sigma_{\gamma},
\end{eqnarray} 
where the probabilities $k_{\gamma}$ of applying $\sigma_{\gamma}$
are non-negative real numbers such that 
$\sum_{\gamma} k_{\gamma} = 1$ (these conditions also ensure that the channel is 
trace preserving and completely positive).

Pauli channels are some of the 
most fundamental noise models in quantum information science~\cite{Terhal}. 
Some notable examples of Pauli channels are the following:
\begin{itemize}
\item \textbf{Bit Flip Channel:} This is a channel that with probability $1-p$ leaves the qubit as it is 
and with probability $p$ it applies the $\sigma_1$ matrix 
(which flips the basis states $|0\rangle$ and $|1\rangle$ of the qubit), and
so it is given by:
\begin{align*}
\mathcal{E}(\rho) = (1-p) \rho + p \sigma_1 \rho \sigma_1.
\end{align*}
Analogous channels exist using $\sigma_3$ (called the bit flip channel,
which has a probability $p$ of adding a relative phase $\pi$ to the state) or 
using $\sigma_2$ (called the phase flip channel, 
which has a probability $p$ of 
flipping the base states and also add a relative phase $\pi$).
\item \textbf{Depolarizing channel:} 
This channel has a probability $1-p$
of doing nothing to the qubit and a probability $p$ of converting it into the maximally mixed state $\dfrac{1}{2} \mathbb{I}$
and it can be written as:
\begin{equation}
\mathcal{E}(\rho) = (1-p)\rho + p \dfrac{1}{2} \mathbb{I} = \left(1 - \dfrac{3p}{4} \right) \sigma + \dfrac{p}{4} \sigma_1 \rho \sigma_1 + \dfrac{p}{4} \sigma_2 \rho \sigma_2+ \dfrac{p}{4} \sigma_3 \rho \sigma_3.
\end{equation} 
\end{itemize}

We can also see how an arbitrary Pauli channel acts on an arbitrary  
density matrix.
To do it, we substitute eq. (\ref{eq: Density Matrix}) 
in eq. (\ref{eq: Pauli channel 1 qbit}):
\begin{equation}
\mathcal{E}(\rho) = \dfrac{1}{2}\sum_{\gamma,\alpha=0}^3 k_{\gamma} r_{\alpha} \sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma}.
\end{equation}
This can be simplified by using the following property of Pauli matrices:
\begin{equation}
\label{eq: propiedad-pauli}
\sigma_{\gamma} \sigma_{\alpha} \sigma_{\gamma} = A_{\alpha,\gamma} \sigma_{\alpha}, \;\;\;\;\; \text{with} \; A_{\alpha,\gamma} = \begin{pmatrix}
1 & 1 & 1 & 1\\
1 & 1 & -1 &-1 \\
1 & -1 & 1 & -1 \\
1 & -1 & -1 & 1
\end{pmatrix},
\end{equation}
which leads to
\begin{equation}
\label{eq: rho-transformada}
\mathcal{E}(\rho) = \dfrac{1}{2} \sum_{\alpha} \left(\sum_{\gamma} A_{\alpha, \gamma} k_{\gamma} \right) r_{\alpha} \sigma_{\alpha}.
\end{equation}
Eq.~(\ref{eq: rho-transformada}) once again has the form of eq.~(\ref{eq: Density Matrix})
but with components $\left( \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma} \right) r_{\alpha}$.
This gives us another way of understanding Pauli channels
as operations that take each component $r_{\alpha}$
of the density matrix and multiplies them
by $\sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}$, 
that is:
\begin{equation}
\label{eq: multipliers}
r_{\alpha}  \xrightarrow[\text{Channel}]{\text{Pauli}}  \tau_{\alpha} r_{\alpha} ,\;\; \tau_{\alpha} := \sum_{\gamma} A_{\alpha,\gamma} k_{\gamma}.
\end{equation}
Notice that $\tau_0 = 1$, which is a consequence of $\sum_{\gamma}k_{\gamma}=1$
and ensures that after the channel, the resulting density matrix still has trace one. 
Furthermore, reverting the definition of $\tau_{\alpha}$ by using that $A^{-1} = \dfrac{1}{4} A$, 
we get that $k_{\gamma} = \dfrac{1}{4} \sum_{\alpha} A_{\alpha,\gamma} \tau_{\alpha}$.
Then, using that $k_{\gamma} \geq 0$
we get the following conditions on the multipliers $\tau_{\alpha}$:
\begin{eqnarray}
\label{eq: conditions-tetrahedron}
&1+\tau_i -\tau_j - \tau_k \geq 0,  \;\;\; \text{for $i,j,k$ different numbers in $\{1,2,3\}$}, \\
&1+\tau_1 + \tau_2 + \tau_3 \geq 0.
\end{eqnarray}

These conditions imply that $(\tau_1,\tau_2,\tau_3)$
has to be inside a tetrahedron with
vertices $(1,1,1), (1,-1,-1),(-1,1,-1)$ and $(-1,-1,1)$. 
Therefore, the $\tau_{1,2,3}$ are numbers between 
$-1$ and $1$, which means that the components
$r_{\alpha}$ of the density matrix are always 
attenuated and possibly sign flipped.

Having defined the one qubit case,  we can now generalize to $N$ qubits.
In order to do it, we need to introduce the so-called \textit{Pauli strings}, defined as
\begin{eqnarray}
\label{eq: Pauli string}
\sigma_{\vec{\alpha}} = \sigma_{\alpha_1} \otimes \sigma_{\alpha_2}\otimes \cdots \otimes \sigma_{\alpha_N},
\end{eqnarray}
where $\vec{\alpha}$ denotes a multi-index $(\alpha_1, \cdots, \alpha_N)$
 and $\alpha_i \in \{0,1,2,3\}$. 
These operators form an orthogonal basis in the space of operators acting on $N$ qubits. 
 Similarly to the single-qubit case, the density matrix $\rho$ 
of a system of $N$ qubits can be written using Pauli strings as:
\begin{equation}
\label{eq:  Density matrix Nqbit}
\rho = \dfrac{1}{2^N} \sum_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}}.
\end{equation}
Then, just as before, we define a Pauli channel as a transformation that applies 
the operator $\sigma_{\vec{\gamma}}$ to $\rho$ with probability $k_{\vec{\gamma}}$
and is therefore described mathematically by:
\begin{equation}
\label{eq: pauli channel N-qubit}
\mathcal{E}(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}} \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{equation}
where just as before, $k_{\vec{\gamma}}$ are non-negative real numbers such 
that $\sum_{\vec{\gamma}} k_{\vec{\gamma}}=1$.

As in the one qubit case, Pauli channels for $N$ qubits 
attenuate the components $r_{\vec{\alpha}}$ of the density matrix.
This can be seen by substituting eq. (\ref{eq:  Density matrix Nqbit}) in eq. (\ref{eq: pauli channel N-qubit})
and using the property of eq. (\ref{eq: propiedad-pauli}):
\begin{align*}
\mathcal{E}(\rho) &= \dfrac{1}{2^N} \sum_{\vec{\gamma},\vec{\alpha}} k_{\vec{\gamma}} r_{\vec{\alpha}} \sigma_{\vec{\gamma}} \sigma_{\vec{\alpha}} \sigma_{\vec{\gamma}} \\
& = \dfrac{1}{2^N} \sum_{\vec{\alpha}} \left( \sum_{\vec{\gamma}} (A^{\otimes^N})_{\vec{\alpha},\vec{\gamma}} \; k_{\vec{\gamma}} \right) r_{\vec{\alpha}} \sigma_{\vec{\alpha}},
\end{align*}
which means that applying the Pauli channel multiplies the 
components $r_{\vec{\alpha}}$ by $\tau_{\vec{\alpha}} := \sum_{\vec{\gamma}} (A^{\otimes^N})_{\vec{\alpha},\vec{\gamma}} k_{\vec{\gamma}}$.
% }}}
\subsection{Pauli Dynamical Maps} % {{{
\label{subsec: Pauli Dynamical Maps}


As seen in the last section, Pauli channels and in 
general quantum channels are discrete maps
that transform a density matrix $\rho$ into $\mathcal{E}(\rho)$.
However, we could also define a continuous set of 
channels $\varepsilon_p$ with $p$ a real parameter.

For the special case of Pauli channels, we define 
a Pauli dynamical map as a continuous parametrized 
curve drawn inside the set of Pauli channels and starting at the identity channel. 
Therefore, a Pauli dynamical map can be written as
\begin{eqnarray}
\label{eq: Pauli dynamical map}
\mathcal{E}_p(\rho) = \sum_{\vec{\gamma}} k_{\vec{\gamma}}(p) \sigma_{\vec{\gamma}} \rho \sigma_{\vec{\gamma}},
\end{eqnarray}
where $p$ is a parameter in an interval $[a,b]$ 
and $\mathcal{E}_p$ is a Pauli channel for every $p$, 
with $\mathcal{E}_a$ being the identity channel.

% }}}
% }}}
\section{Circuit for a Pauli Channel} % {{{
\label{subsec: Circuit for a Pauli Channel}

\cpnote{Acá voy}

In this section we propose a quantum circuit that simulates $N$-qubit Pauli
channels.  Moreover, we implement the circuit for $N=1$ on a quantum computer
and analyze the results\cpnote{Quizá en una frase poner el resultado aca o ampliar
tantito}.

\cpnote{Yo abriría este parrafo con una frase que de la idea muy general. Decir 
algo asi como que vamos a crear un estado conque contenga a las $k$s 
como coeficientes y leugo controlar la aplicación de los Pauli strings. Luego
ya dar los detalles. Así incluso mas escueto de lo que pongo. Por ejemplo:
To design the circiot that implements 13, we construct a state that incorportes
probabilities $k$ and subsequently apply controlled operation. In particular... }
\cpnote{No me gusta como está organizado este parrafo. Le puedes dar una iterada?}
To design the circuit, we remember that a Pauli channel as the one in
eq.~(\ref{eq: pauli channel N-qubit})
applies each Pauli operator $\sigma_{\vec{\gamma}}$ on $\rho$ with a probability $k_{\vec{\gamma}}$.
Given this, it is easy to construct a quantum circuit that implements 
a Pauli channel with the help of $2N$ ancilla qubits,
the circuit that does this is presented in fig. (\ref{fig: circuit-pauli}).
The general idea is to produce the probabilities $k_{\gamma}$ by creating the state
\begin{eqnarray}
\label{eq: state}
\sum_{\vec{\gamma}} b_{\vec{\gamma}} |\vec{\gamma} \rangle
\end{eqnarray}
in the ancilla qubits, 
where $b_{\vec{\gamma}}$ are numbers such that $
|b_{\vec{\gamma}}|^2 = k_{\vec{\gamma}}$.
The $2N$-qubit state $|\vec{\gamma}\rangle$  is defined by $|\gamma_1 \rangle \cdots |\gamma_N\rangle$.

%Moreover $|\vec{\gamma}\rangle$ is defined as a $2n$ qubit state given by
%\begin{eqnarray}
%|\vec{\gamma} \rangle = |\gamma_1\rangle |\gamma_2 \rangle \cdots |\gamma_N \rangle,
%\end{eqnarray}
%where $|\gamma_i \rangle$ is the $2$ qubit state $|00\rangle, |01\rangle , |10\rangle$ or $|11\rangle$ when $\gamma_i = 0,1,2,3$ respectively. \\


\begin{figure}[h!]
\centering
% \begin{quantikz}
% \lstick{$q:\; |0\rangle^{\otimes N}$} & \qw & \gate{\sigma_{\vec{\gamma} }} \gategroup[wires=2,steps
% =1,style={dashed, inner sep=4pt}]{Repeat for all $\vec{\gamma}$}
% \gategroup[wires=2,steps
% =1,style={dashed, inner sep=4pt}, label style = {label position = below, yshift = 0.15cm}]
% {$|\vec{\gamma}\rangle$} & \qw \\
% \lstick{$\tilde{q}:\; |0\rangle^{\otimes 2N}$} & \gate[wires=1]{\text{Create the $2N$ qubits state $\sum_{\vec{\gamma}} b_{\vec{\gamma}}   |\vec{\gamma} \rangle$}} & \ctrl{-1} 
% % \gategroup[wires=1,steps
% %=1,style={color=white, inner sep=0pt}, label style= {label position=below}]{$|\vec{\gamma}\rangle$} 
% & \qw 
% \end{quantikz}
\includegraphics{images/circuito_general.pdf}
\caption{\cpnote{Revisa el archivo images/circuito\_general.pdf y el makefile correspondiente} {\bf Circuit for an $N$-qubit Pauli channel on $N$ qubits.}
The circuit creates the state $\sum_{\vec{\gamma}} b_{\vec{\gamma}}|\vec{\gamma}\rangle$ 
on the $2N$ ancilla qubits denoted by $\tilde{q}$. 
Then, for every vector $\vec{\gamma}$, it applies the operator $\sigma_{\vec{\gamma}}$ 
if the ancilla qubits are in the state $\vec{\gamma}$.}
\label{fig: circuit-pauli}
\end{figure}

\cpnote{La primera frase es cierta, pero no le veo el sentido acá. Trata de reformular el parrafo 
de nuevo. Croe que el ``This means'' definitivamente no va y es el que le da un sentido ``raro''. 
Itera (quizá solo quitando esas dos palabras)}
This means that when measured in the computational basis, the state given in eq.~(\ref{eq: state})
collapses to $|\vec{\gamma}\rangle$ with a 
probability $|b_{\vec{\gamma}}|^2 = k_{\vec\gamma}$. 
The circuit in fig.~(\ref{fig: circuit-pauli}) uses this fact
to operate $\sigma_{\vec{\gamma}}$ on the principal qubits
with a probability $k_{\vec\gamma}$ by using controlled operations 
that apply $\sigma_{\vec{\gamma}}$ to the principal qubits
only if the ancilla qubits are in the state $|\vec{\gamma}\rangle$.
Therefore, the circuit from fig.~(\ref{fig: circuit-pauli}) 
applies each operation $\sigma_{\vec{\gamma}}$ to the principal qubits 
with a probability $k_{\vec{\gamma}}$, 
just as a Pauli channel is supposed to do.  
\cpnote{Del circuito, parece ue las fases de las bs gammas no omportan mucho (o nada). 
Esa libertad la hemos considerado? De alguna manera colapsan curvas de las que
hemos visto?}

\subsection{Simulation for one-qubit Pauli channels} % {{{
\label{subsec: Simulation for one-qubit Pauli channels}
\cpnote{Es raro tener una sola subseccion. De perdida dos, o ninguna. Charlemso a ver como 
reorganizar las secciones (creo que el flujo si va bien hasta ahora)}


For the particular case of a Pauli channel on one qubit, the circuit that
simulates it can be constructed as in fig.~\ref{fig: citcuit-pauli-1},
 which is a special case of fig. \ref{fig: circuit-pauli}
 but with all qubits \cpnote{y compuertas , etc digamos que details} explicitly shown.

\begin{figure}[h!]
\centering
\begin{quantikz}
\lstick{$q_0$} & \qw & \gate{\sigma_1} & \gate{\sigma_2} & \gate{\sigma_3} & \qw \\
\lstick{$\tilde{q}_0$} & \gate[wires=2][3cm]{\quad\quad \text{Create the two qubits state}\quad\quad} & \octrl{-1} & \ctrl{-1} & \ctrl{-1} & \qw \\
\lstick{$\tilde{q}_1$} & \gateinput{$\;\;\;\;\;b_0 |0 \rangle |0 \rangle + b_1 |0 \rangle |1 \rangle + b_2 |1 \rangle |0 \rangle + b_3 |1 \rangle |1 \rangle $} & \ctrl{-2} & \octrl{-2}  & \ctrl{-2} & \qw
\end{quantikz}
\caption{\cpnote{si quieres, intenta hacer la figura tu solo basado en el lo quehabía hecho. 
Otra cosa quizá para discutir. La creacion del estado especial de dos qubits no esta
aca explicita. Eso creo que si lo podemos hacer en general, o no? Como sería eso? Lo discutimos
a ver si lo pones?
} {\bf One qubit Pauli channel circuit.} Circuit for a one-qubit Pauli channel, which is a particular case of Fig~(\ref{fig: circuit-pauli}).}
\label{fig: citcuit-pauli-1} 
\end{figure}
Taking advantage of the quantum computers that IBM has available~\cite{Qiskit},
we sampled $249$ one-qubit Pauli channels and simulated them using the 
ibmq-lima quantum computer. 
For each of these channels, we used quantum process tomography~\cite{Qiskit,
Chuang:1996} to obtain the Choi matrix corresponding to the implementation of
the circuit $\mathcal{C}_{I}$ .
Then, we compared this Choi matrix with the theoretical
Choi matrix $\mathcal{C}_T$ of the channel we wanted to implement\cpnote{Quizá
referirnos mejor al canal? Lo discutimos}.

To perform this comparison, we used the diamond norm~\cite{Aharonov},
which allows us to discriminate \cpnote{creo qeu todas lasnormas nos
permiten discriminar entre canales. itera} between quantum channels.
Suppose an agent is given one of the channels $\mathcal{C}_I$, $\mathcal{C}_T$
with probability $1/2$ for each \cpnote{que pasa para una probabilidad $p$?
Otra cosa, los canales no se caracterizan por lo general po rla matriz 
de choi, tonces por aca quizá hay problemas. Discutamos notacion.},
and tries to guess which channel they received
by passing through it a state $\rho$ and measuring the result.
Then, the maximal probability of success (out of all possible states $\rho$) that
the agent guesses correctly is~\cite{Benenti}:
\begin{equation}
\label{eq: probability-success}
p_{succ} = \dfrac{1}{2}+ \dfrac{1}{2} ||\mathcal{C}_I - \mathcal{C}_T ||_{\diamond},
\end{equation}
where $|| \cdot ||_{\diamond}$ is the diamond norm.  Notice that $p_{succ}=1/2$
means that the channels are the same \cpnote{qioza una frase explicando porque
esto es razonable}, while $p_{succ}=1$ indicates that they are perfectly
distinguishable \cpnote{hummm ejemplo al menos para nosotros.}.

Finally, using the representation of Pauli channels in a tetrahedron as
in eq.~(\ref{eq: conditions-tetrahedron}),
we show in fig.~(\ref{fig: fidelity one qubit}) the maximal probabilities of
success defined by eq. (\ref{eq: probability-success}) for the channels
analyzed. \cpnote{Falta analisis de los resultados. }

\cpnote{Mejorar la figura, quizá dejando la tridimensional y ademas poniendo unos 6 cortes. Probar
con diferentes colores.
}

\begin{figure}[h!]
\centering
\includegraphics[width=0.45\textwidth]{probabilities-points.png}\\
\caption{\tbnote{Al igual que antes, hay que quitar esta figura y ponerla en un archivo a parte}. {\bf Maximal probabilities of success for one-qubit Pauli channel} $p_{succ}$ of one-qubit Pauli channels implemented on IBM's ibmq-lima. The channels are plotted in the tetrahedron of Pauli channels, with a color bar indicating the distinguishability of each channel's implementation using the circuit for a 1-qubit Pauli channel.}
\label{fig: fidelity one qubit}
\end{figure}


% }}}
% }}}
\section{OPR Circuits} % {{{
\label{sec: OPR Circuits}
Dynamical maps can be implemented using the same circuit as 
in Fig~(\ref{fig: circuit-pauli}), with the only difference that now the state 
to be created on the ancilla qubits depends on parameter $p$ 
and therefore is given by 
\begin{eqnarray}
\label{eq: parametrized state}
\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle.
\end{eqnarray}

\textbf{Puntos:}
\begin{itemize}
\item As said before, to implement a Pauli dynamical map, 
we need to create the parametrized $2n$-qubit state 
$\sum_{\vec{\gamma}} b_{\vec{\gamma}}(p) |\vec{\gamma}\rangle$ on the ancilla qubits.
\item However, creating this state will in general require many rotations parametrized by $p$. 
For example, for the case of a Pauli dynamical map on 1 qubit, 
the parametrized state of the $2$ ancilla qubits in general requires $3$ parametrized rotations and can be constructed as follows: (poner circuito).\\
In general, to create a parametrized state on $2n$ ancilla qubits will require
$2n-1$ rotations parametrized by $p$.
\item How can we reduce the amount of parametrized rotations used?
\item \textbf{OPR Circuit:} Define an OPR circuit (a circuit with one parametrized rotation)
\item \textbf{Theorem about OPR circuits:} \textit{An OPR circuit on $n$ qubits with parameter $p$ always has an operator of the form:}
\begin{eqnarray}
U = (\vec{v}_0| \vec{v}_1| \cdots| \vec{v}_{2^n-1})
\end{eqnarray}
\textit{where $s = s(p)$ and the column vectors are $\vec{v}_j = e^{is} \vec{a}_j + e^{-is} \vec{b}_j + \vec{c}_j$, with $\vec{a}_j, \vec{b}_j, \vec{c}_j$ orthogonal vectors and $|\vec{a}_j|^2 + |\vec{b}_j|^2 + |\vec{c}_j|^2 = 1$.}
\item \textbf{Proof:} La prueba está dentro de las ``Cosas-Escritas-Antes'', 
aunque se puede y debe achicar bastante.
\end{itemize}
% }}}
\section{OPR circuit for a Pauli map} % {{{
\label{sec: OPR circuit for a Pauli map}
\textbf{Puntos:}
\begin{itemize}
\item Use the last theorem to conclude directly which maps can be created using an OPR circuit.
\item \textbf{Examples:} Show examples that satisfy these conditions: Bit-Flip, parabolic maps, etc. 
and an example that doesn't satisfy the conditions (ejemplo está en la tesis).
\item \textbf{Results:} Show results of simulating those maps on a quantum computer. 
Lo tengo para parabolic y para depolarizing.
\end{itemize}
% }}}
\section{Exponential maps $e^{iHt}$} % {{{
\label{sec: Exponential maps}
\textbf{Puntos:}

\begin{itemize}
\item We will apply the results about OPR circuit to another kind of operation, those given by $U  = e^{iHt}$ where $H$ is hermitian  and time independent.
\item \textbf{Lemma:}\textit{ The $n$-qubit operator $U^{iHt}$ can be implemented with an OPR circuit of $n$ qubits if and only if $D = \text{diag}(e^{i\lambda_0 t}, \cdots, e^{i \lambda_{2^n-1}t})$ can be implemented with an OPR circuit of $n$ qubits, where $\lambda_j$ are the eigenvalues of $H$.}
\item \textbf{Proof:}  Es b\'asicamente usar que $H = QDQ^{-1}$ para una matriz $Q$ que no depende de $t$ y por lo tanto no agrega compuertas parametrizadas al circuito. 
\item \textbf{Theorem:} \textit{ A n-qubit operator of the form $U = e^{iHt}$ can be implemented using an OPR circuit if and only if the eigenvalues of $H$ are $-\lambda,0,\lambda$ (for $\lambda$ a real number) and the degeneracies of $\lambda$ and $-\lambda$ are both equal to $2^j$ for some $j\in \{0,1,\cdots,n-1\}$.}
\item \textbf{Proof:} Estoy buscando formas de simplificar la prueba, porque es medio larguita. Pero básicamente es usar el lema y entonces preocuparnos sólo por $D$. Luego  usar el teorema de la sección 3 y notar que sólo hay tres tipos de  $\lambda$s posibles y luego notar que deben de tener esas degeneraciones.
\item \textbf{Proof del regreso:} Aquí quiero recalcar que la prueba es constructiva, ya que consiste en mostrar cómo construir el circuito OPR que hace la operación a partir de una $H$ que cumpla la hipótesis. 
\item \textbf{Examples.} Mencionar que por el teorema, los ejemplos son sistemas con 3 energías separadas por la misma distancia y con las degeneraciones dadas en el teorema. 
La verdad que no se me ocurren sistemas físicos comunes que cumplan eso.
\begin{itemize}
\item Cualquier matriz $H$ de un qubit cumple el teorema.
\item Cualquier matriz de $n$ qubits que sea el producto tensorial de matrices de Pauli para cada partícula (o sea algo como $\sigma_{i_1} \otimes \sigma_{i_2} \otimes \cdots \otimes \sigma_{i_n}$) cumple el teorema.
\item Estoy viendo para cadenas de espines si hay condiciones para las que cumplan las hipótesis del teorema, pero no he encontrado aún.
\end{itemize}
\item Hice explícitamente el circuito de 2 qubits para $H = \sigma_3 \otimes \sigma_2$ y lo simulé en las computadoras de IBM, obteniendo una fidelidad de $0.85$.
\end{itemize}
% }}}
\section{Conclusion} % {{{

CO\textsubscript{2} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque. Quisque augue sem, tincidunt sit amet feugiat eget, ullamcorper sed velit. 

Sed non aliquet felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris commodo justo ac dui pretium imperdiet. Sed suscipit iaculis mi at feugiat. Ut neque ipsum, luctus id lacus ut, laoreet scelerisque urna. Phasellus venenatis, tortor nec vestibulum mattis, massa tortor interdum felis, nec pellentesque metus tortor nec nisl. Ut ornare mauris tellus, vel dapibus arcu suscipit sed. Nam condimentum sem eget mollis euismod. Nullam dui urna, gravida venenatis dui et, tincidunt sodales ex. Nunc est dui, sodales sed mauris nec, auctor sagittis leo. Aliquam tincidunt, ex in facilisis elementum, libero lectus luctus est, non vulputate nisl augue at dolor. For more information, see \nameref{S1_Appendix}.
% }}}
\section{Supporting information} % {{{

% Include only the SI item label in the paragraph heading. Use the \nameref{label} command to cite SI items in the text.
\paragraph*{S1 Fig.}
\label{S1_Fig}
{\bf Bold the title sentence.} Add descriptive text after the title of the item (optional).

\paragraph*{S2 Fig.}
\label{S2_Fig}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 File.}
\label{S1_File}
{\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Video.}
\label{S1_Video}
{\bf Lorem ipsum.}  Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Appendix.}
\label{S1_Appendix}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.

\paragraph*{S1 Table.}
\label{S1_Table}
{\bf Lorem ipsum.} Maecenas convallis mauris sit amet sem ultrices gravida. Etiam eget sapien nibh. Sed ac ipsum eget enim egestas ullamcorper nec euismod ligula. Curabitur fringilla pulvinar lectus consectetur pellentesque.
% }}}
\section{Acknowledgments} % {{{
Support by projects CONACyT 285754, 254515 and UNAM-PAPIIT IG100518, IG101421 is
acknowledged. 


\nolinenumbers

% }}}
% Biblbiografia {{{
% Either type in your references using
% \begin{thebibliography}{}
% \bibitem{}
% Text
% \end{thebibliography}
%
% or
%
% Compile your BiBTeX database using our plos2015.bst
% style file and paste the contents of your .bbl file
% here. See http://journals.plos.org/plosone/s/latex for 
% step-by-step instructions.
% 
%\begin{thebibliography}{10}
%
%\bibitem{bib1}
%Conant GC, Wolfe KH.
%\newblock {{T}urning a hobby into a job: how duplicated genes find new
%  functions}.
%\newblock Nat Rev Genet. 2008 Dec;9(12):938--950.

%\bibitem{bib2}
%Ohno S.
%\newblock Evolution by gene duplication.
%\newblock London: George Alien \& Unwin Ltd. Berlin, %Heidelberg and New York:
%  Springer-Verlag.; 1970.

%\bibitem{bib3}
%Magwire MM, Bayer F, Webster CL, Cao C, Jiggins FM.
%\newblock {{S}uccessive increases in the resistance of {D}rosophila to viral
%  infection through a transposon insertion followed by a {D}uplication}.
%\newblock PLoS Genet. 2011 Oct;7(10):e1002337.
%
%\end{thebibliography}
\tbnote{Poner la bibliografía como ellos dicen (copiarla toda aquí en lugar de ponerla en un archivo .bib)}
\textbf{References}
\bibliography{Bibliography}

% }}}
\newpage
\appendix
\input{Cosas-Escritas-Antes}


\end{document}
